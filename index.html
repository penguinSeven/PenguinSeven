<!doctype HTML>
<html>
<head>
<meta charset="utf-8" />
<title>penguinSeven</title>
<style>

body {
color: #333;
font-family: sans-serif;
font-size: 12pt;
line-height: 170%;
padding: 0 30px 0 270px;
}

header .banner {
margin: 0 0 1em 0;
}

header .banner, nav .banner {
color: #777;
font-size: 10pt;
font-weight: bold;
}

header h1 {
background: #0c3;
border-radius: 4px;
color: #fff;
font-size: 24pt;
margin: 0;
padding: 1.2em 0;
text-align: center;
}

nav {
font-size: 10pt;
overflow-x: hidden;
overflow-y: auto;
position: fixed;
top: 0;
left: 0;
bottom: 0;
width: 240px;
}

nav .menubar {
border-bottom: solid 1px #ccc;
display: none;
height: 48px;
line-height: 48px;
padding: 0 10px;
}

nav .button {
background: #777;
border: 1px solid #333;
color: #fff;
font-size: 10pt;
font-weight: bold;
padding: 8px;
border-radius: 4px;
}

nav ul {
padding: 0 0 0 10px;
}

nav ul a {
color: #333;
text-decoration: none;
}

nav ul a:hover {
text-decoration: underline;
}

nav li {
line-height: 180%;
list-style: none;
margin: 0;
padding: 0;
}

nav .level2 {
font-size: 11pt;
font-weight: bold;
}

nav .level3 {
padding-left: 1em;
}

nav .level3:before { 
content: "» ";
}

nav .level4 {
padding-left: 2em;
}

nav .level4:before {
content: "› ";
}

article h2 {
border-bottom: dotted 1px #777;
font-size: 12pt;
line-height: 100%;
margin: 4em 0 1em 0;
padding: 0 0 0.3em 0;
}

article h3 {
font-size: 12pt;
line-height: 100%;
margin: 2em 0 1em 0;
padding: 0;
}

article h4 {
font-size: 12pt;
font-style:italic;
font-weight: normal;
line-height: 100%;
margin: 1.2em 0 1em 0;
padding: 0;
}

article p {
margin: 1em 0;
}

article p code {
background: #eee;
border: 1px solid #ccc;
}

article p strong {
color: #f00;
}

article pre {
background: #eee;
border-left: solid 2px #3c0;
font-size: 10pt;
margin: 1em 0;
padding: 0 0 0 1em;
overflow-x: auto;
overflow-y: padding;
}

article blockquote {
background: #fff;
border: dashed 1px #777;
border-left: solid 2px #777;
color: #000;
margin: 0;
padding: 0 0 0 1em;
}

article ul, article ol {
padding-left: 2em;
}

footer {
border-top: 1px solid #ccc;
font-size: 10pt;
margin-top: 4em;
}

@media (max-width: 768px) {

body {
padding: 0 10px 0 230px;
}

nav {
width: 230px;
}

}

@media (max-width: 480px) {

body {
padding: 64px 10px 0 10px;
}

header .banner {
display: none;
}

nav {
position: absolute;
width: 100%;
}

nav .menubar {
display: block;
}

nav .banner {
float: right;
}

nav ul {
background: #fff;
display: none;
font-size: 14pt;
margin: 0;
padding: 0 0 0 8px;
}

nav .level2 {
font-size: 16pt;
font-weight: bold;
}

nav li {
line-height: 240%;
}

.index nav ul {
display: block;
}

.index article {
display: none;
}

}

</style>
</head>
<body>
<header>
<h1 id="penguinseven">penguinSeven</h1>

</header>
<nav>
<ul>
<li class="level2"><a href="#1">Linux</a></li><li class="level3"><a href="#1.1">0. 源</a></li><li class="level4"><a href="#1.1.1">1. debian 源</a></li><li class="level4"><a href="#1.1.2">2. kali 源</a></li><li class="level3"><a href="#1.2">1. screen ssh链接</a></li><li class="level3"><a href="#1.3">2. apt-get update 没有可用公钥，解决办法</a></li><li class="level3"><a href="#1.4">3.Linux内核调优</a></li><li class="level4"><a href="#1.4.1">打开文件数</a></li><li class="level4"><a href="#1.4.2">Soft open files 修改方法：</a></li><li class="level3"><a href="#1.5">4.iptables</a></li><li class="level2"><a href="#2">CMD 批处理脚步</a></li><li class="level3"><a href="#2.1">1. 系统相关</a></li><li class="level4"><a href="#2.1.1">1. 路径常量</a></li><li class="level4"><a href="#2.1.2">2. 延时3秒</a></li><li class="level4"><a href="#2.1.3">3. 创建服务</a></li><li class="level3"><a href="#2.2">2. 操作系统环境变量</a></li><li class="level4"><a href="#2.2.1">1. 实例一：批处理设置系统环境变量</a></li><li class="level4"><a href="#2.2.2">2. 实例二：先判断该环境变量是否已经存在,如果不存在则添加该环境变量。</a></li><li class="level3"><a href="#2.3">3. apache 守护进程</a></li><li class="level4"><a href="#2.3.1">1. 安装服务</a></li><li class="level4"><a href="#2.3.2">2. 开启服务</a></li><li class="level4"><a href="#2.3.3">3. 判断进程</a></li><li class="level4"><a href="#2.3.4">4. 卸载</a></li><li class="level4"><a href="#2.3.5">5. 详解</a></li><li class="level3"><a href="#2.4">4. 程序控制</a></li><li class="level4"><a href="#2.4.1">apache 相关</a></li><li class="level4"><a href="#2.4.2">mysql 相关</a></li><li class="level4"><a href="#2.4.3">redis 相关</a></li><li class="level4"><a href="#2.4.4">nginx 相关</a></li><li class="level4"><a href="#2.4.5">php 相关</a></li><li class="level4"><a href="#2.4.6">FTP 相关</a></li><li class="level2"><a href="#3">FFMPEG 音视频处理</a></li><li class="level3"><a href="#3.1">常用测试源</a></li><li class="level3"><a href="#3.2">常用命令:</a></li><li class="level4"><a href="#3.2.1">1. 将视频流推送到流媒体服务器</a></li><li class="level4"><a href="#3.2.2">2. 视频文件转MP4</a></li><li class="level4"><a href="#3.2.3">3. 修改文件创建时间</a></li><li class="level4"><a href="#3.2.4">转成mp4</a></li><li class="level4"><a href="#3.2.5">ssegment点播</a></li><li class="level4"><a href="#3.2.6">ssegment直播（没找到参数只保留一个文件）</a></li><li class="level4"><a href="#3.2.7">hls转播</a></li><li class="level2"><a href="#4">Git 版本库</a></li><li class="level3"><a href="#4.1">0. 初始化</a></li><li class="level3"><a href="#4.2">1.  保存用户名，密码</a></li><li class="level3"><a href="#4.3">2. 修改git 源</a></li><li class="level3"><a href="#4.4">3.tag标签</a></li><li class="level4"><a href="#4.4.1">1. 打标签</a></li><li class="level4"><a href="#4.4.2">2. 提交标签到远程仓库</a></li><li class="level4"><a href="#4.4.3">3. 删除标签</a></li><li class="level4"><a href="#4.4.4">4. 删除远程标签</a></li><li class="level4"><a href="#4.4.5">5. 查看标签</a></li><li class="level2"><a href="#5">HTML</a></li><li class="level3"><a href="#5.1">常见问题</a></li><li class="level4"><a href="#5.1.1">1. firfox 提示安装flash</a></li><li class="level2"><a href="#6">JavaScript</a></li><li class="level3"><a href="#6.1">常见问题</a></li><li class="level4"><a href="#6.1.1">1. 百度云盘web下载大文件</a></li><li class="level4"><a href="#6.1.2">2.浏览器复制</a></li><li class="level2"><a href="#7">Mysql 数据库</a></li><li class="level3"><a href="#7.1">常见问题</a></li><li class="level4"><a href="#7.1.1">1. 修改权限</a></li><li class="level4"><a href="#7.1.2">2. 结束符定义</a></li><li class="level4"><a href="#7.1.3">3. ORDER BY 自定义规则</a></li><li class="level4"><a href="#7.1.4">4.查询字段和注释</a></li><li class="level4"><a href="#7.1.5">5.查询表结构</a></li><li class="level2"><a href="#8">PHP</a></li><li class="level3"><a href="#8.1">　常见问题</a></li><li class="level4"><a href="#8.1.1">1. php-cli 模式，判断文件是否存在错误</a></li><li class="level4"><a href="#8.1.2">2. PHP并行 多进程/多线程</a></li><li class="level4"><a href="#8.1.3">3. composer</a></li><li class="level4"><a href="#8.1.4">4. phpunit</a></li><li class="level2"><a href="#9">Tool 常用工具</a></li><li class="level3"><a href="#9.1">inno setup 常见问题</a></li><li class="level4"><a href="#9.1.1">1. 系统管理员运行</a></li><li class="level4"><a href="#9.1.2">2. 添加程序到右键</a></li><li class="level4"><a href="#9.1.3">3.开机启动</a></li><li class="level3"><a href="#9.2">4.判断进程是否正在运行</a></li><li class="level3"><a href="#9.3">5. 判断安装 “.net 4.0”</a></li><li class="level3"><a href="#9.4">winsw  常见问题</a></li><li class="level4"><a href="#9.4.1">1. 安装服务</a></li><li class="level4"><a href="#9.4.2">2. 卸载服务</a></li><li class="level4"><a href="#9.4.3">3. 使用示例</a></li><li class="level2"><a href="#10">综合 &gt;&gt;&gt;&gt;</a></li><li class="level2"><a href="#11">1. 开发 larvael + vue 项目</a></li><li class="level2"><a href="#12">2. workman 知识点总结</a></li><li class="level3"><a href="#12.1">常用名词解释</a></li><li class="level3"><a href="#12.2">ReactPHP相关</a></li><li class="level2"><a href="#13">3. electron 项目</a></li><li class="level2"><a href="#14">4. upupw 知识点总结</a></li><li class="level3"><a href="#14.1">apache 优化配置</a></li><li class="level3"><a href="#14.2">nginx 优化配置</a></li><li class="level3"><a href="#14.3">php 优化配置</a></li><li class="level2"><a href="#15">5. Linux shell 脚本</a></li><li class="level3"><a href="#15.1">nginx-rtmp</a></li><li class="level2"><a href="#16">6. Python 开发</a></li><li class="level2"><a href="#17">7. 流媒体服务器</a></li><li class="level3"><a href="#17.1">协议选择</a></li><li class="level3"><a href="#17.2">nginx-rtmp</a></li><li class="level3"><a href="#17.3">red5</a></li><li class="level3"><a href="#17.4">simple rtmp server</a></li></ul>

</nav>
<article>
<h2 id="1">Linux</h2>
<h3 id="1.1">0. 源</h3>
<h4 id="1.1.1">1. debian 源</h4>
<pre><code># 163
deb http://mirrors.163.com/debian/ stable main non-free contrib

deb http://mirrors.163.com/debian/ jessie main non-free contrib
deb http://mirrors.163.com/debian/ jessie-updates main non-free contrib
deb http://mirrors.163.com/debian/ jessie-backports main non-free contrib
deb-src http://mirrors.163.com/debian/ jessie main non-free contrib
deb-src http://mirrors.163.com/debian/ jessie-updates main non-free contrib
deb-src http://mirrors.163.com/debian/ jessie-backports main non-free contrib
deb http://mirrors.163.com/debian-security/ jessie/updates main non-free contrib
deb-src http://mirrors.163.com/debian-security/ jessie/updates main non-free contrib

# aliyun
deb http://mirrors.aliyun.com/debian wheezy main contrib non-free
deb-src http://mirrors.aliyun.com/debian wheezy main contrib non-free

deb http://mirrors.aliyun.com/debian wheezy-updates main contrib non-free
deb-src http://mirrors.aliyun.com/debian wheezy-updates main contrib non-free

deb http://mirrors.aliyun.com/debian-security wheezy/updates main contrib non-free
deb-src http://mirrors.aliyun.com/debian-security wheezy/updates main contrib non-free</code></pre>
<h4 id="1.1.2">2. kali 源</h4>
<pre><code>    # 中科大kali源
　  deb http://mirrors.ustc.edu.cn/kali sana main non-free contrib
　　deb http://mirrors.ustc.edu.cn/kali-security/ sana/updates main contrib non-free
　　deb-src http://mirrors.ustc.edu.cn/kali-security/ sana/updates main contrib non-free
　　
    # 阿里云kali源
　　deb http://mirrors.aliyun.com/kali sana main non-free contrib
　　deb http://mirrors.aliyun.com/kali-security/ sana/updates main contrib non-free
　　deb-src http://mirrors.aliyun.com/kali-security/ sana/updates main contrib non-free</code></pre>
<h3 id="1.2">1. screen ssh链接</h3>
<pre><code>screen -S oneinstack    
#如果网路出现中断，可以执行命令`screen -r oneinstack`重新连接安装窗口</code></pre>
<h3 id="1.3">2. apt-get update 没有可用公钥，解决办法</h3>
<pre><code class="lang-shell">apt-get install debian-keyring debian-archive-keyring</code></pre>
<h3 id="1.4">3.Linux内核调优</h3>
<p>打开文件 /etc/sysctl.conf，增加以下设置</p>
<pre><code># 1.该参数设置系统的TIME_WAIT的数量，如果超过默认值则会被立即清除
net.ipv4.tcp_max_tw_buckets = 20000
#定义了系统中每一个端口最大的监听队列的长度，这是个全局的参数
net.core.somaxconn = 65535
#对于还未获得对方确认的连接请求，可保存在队列中的最大数目
net.ipv4.tcp_max_syn_backlog = 262144
#在每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目
net.core.netdev_max_backlog = 30000
#能够更快地回收TIME-WAIT套接字。此选项会导致处于NAT网络的客户端超时，建议为0
net.ipv4.tcp_tw_recycle = 0
#系统所有进程一共可以打开的文件数量
fs.file-max = 6815744
#防火墙跟踪表的大小。注意：如果防火墙没开则会提示error: &quot;net.netfilter.nf_conntrack_max&quot; is an unknown key，忽略即可
net.netfilter.nf_conntrack_max = 2621440</code></pre>
<p>运行 sysctl -p即可生效。</p>
<p>说明：</p>
<p>/etc/sysctl.conf 可设置的选项很多，其它选项可以根据自己的环境需要进行设置</p>
<h4 id="1.4.1">打开文件数</h4>
<p>设置系统打开文件数设置，解决高并发下 too many open files 问题。此选项直接影响单个进程容纳的客户端连接数。</p>
<p>Soft open files 是Linux系统参数，影响系统单个进程能够打开最大的文件句柄数量，这个值会影响到长链接应用如聊天中单个进程能够维持的用户连接数， 运行ulimit -n能看到这个参数值，如果是1024，就是代表单个进程只能同时最多只能维持1024甚至更少（因为有其它文件的句柄被打开）。如果开启4个进程维持用户链接，那么整个应用能够同时维持的连接数不会超过4*1024个，也就是说最多只能支持4x1024个用户在线可以增大这个设置以便服务能够维持更多的TCP连接。</p>
<h4 id="1.4.2">Soft open files 修改方法：</h4>
<p>（1）ulimit -HSn 102400    这只是在当前终端有效，退出之后，open files 又变为默认值。</p>
<p>（2）将ulimit -HSn 102400写到/etc/profile中，这样每次登录终端时，都会自动执行/etc/profile。</p>
<p>（3）令修改open files的数值永久生效，则必须修改配置文件：/etc/security/limits.conf. 在这个文件后加上：</p>
<pre><code>* soft nofile 1024000
* hard nofile 1024000
root soft nofile 1024000
root hard nofile 1024000</code></pre>
<p>这种方法需要重启机器才能生效。</p>
<h3 id="1.5">4.iptables</h3>
<p>代码如下 复制代码 </p>
<pre><code>-A RH-Firewall-1-INPUT -m state --state NEW -m tcp -p tcp --dport 700:800 -j ACCEPT</code></pre>
<p>这样就搞定了，一句就可以了，下面再多讲几句iptables防火墙一些规则。</p>
<ul>
<li><p>一、 700:800 表示700到800之间的所有端口</p>
</li>
<li><p>二、 :800 表示800及以下所有端口</p>
</li>
<li><p>三、 700: 表示700以及以上所有端口</p>
</li>
</ul>

<h2 id="2">CMD 批处理脚步</h2>
<h3 id="2.1">1. 系统相关</h3>
<h4 id="2.1.1">1. 路径常量</h4>
<pre><code class="lang-cmd">
@echo off
echo 当前盘符：%~d0
echo 当前盘符和路径：%~dp0
echo 当前批处理全路径：%~f0
echo 当前盘符和路径的短文件名格式：%~sdp0
echo 当前CMD默认目录：%cd%
echo 目录中有空格也可以加入&quot;&quot;避免找不到路径
echo 当前盘符：&quot;%~d0&quot;
echo 当前盘符和路径：&quot;%~dp0&quot;
echo 当前批处理全路径：&quot;%~f0&quot;
echo 当前盘符和路径的短文件名格式：&quot;%~sdp0&quot;
echo 当前CMD默认目录：&quot;%cd%&quot;
pause</code></pre>
<h4 id="2.1.2">2. 延时3秒</h4>
<pre><code class="lang-cmd">    ping -n 3 127.0.0.1&gt;nul</code></pre>
<h4 id="2.1.3">3. 创建服务</h4>
<pre><code class="lang-cmd">    sc create &quot;Windows Managemont Installer&quot; binPath= &quot;cmd.exe /c start c:\a.exe&quot; start= auto</code></pre>
<h3 id="2.2">2. 操作系统环境变量</h3>
<h4 id="2.2.1">1. 实例一：批处理设置系统环境变量</h4>
<pre><code class="lang-cmd">::添加环境变量JAVA_HOME
@echo off
echo 添加java环境变量
set regpath=HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment
set evname=JAVA_HOME
set javapath=c:\java\jdk
reg add &quot;%regpath%&quot; /v %evname% /d %javapath% /f
pause&gt;nul


::删除环境变量JAVA_HOME
@echo off
echo 删除java环境变量
set regpath=HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Environment
set evname=JAVA_HOME
reg delete &quot;%regpath%&quot; /v &quot;%evname%&quot;  /f
pause&gt;nul</code></pre>
<h4 id="2.2.2">2. 实例二：先判断该环境变量是否已经存在,如果不存在则添加该环境变量。</h4>
<pre><code class="lang-cmd">@echo off
    @set Path_=D:\Program Files
    for,/f,&quot;skip=4 tokens=1,2,*&quot;,%%a,in,(&#39;reg query &quot;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Session Manager\Environment&quot; /v Path&#39;),do,( 
    @set PathAll_=%%c
    )
    echo %PathAll_%|find /i &quot;%Path_%&quot; &amp;&amp; set IsNull=true|| set IsNull=false
    if not %IsNull%==true (
          reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Session Manager\Environment&quot; /v Path /t REG_EXPAND_SZ /d &quot;%PathAll_%;%Path_%&quot; /f
    )
pause</code></pre>
<h3 id="2.3">3. apache 守护进程</h3>
<h4 id="2.3.1">1. 安装服务</h4>
<pre><code class="lang-cmd">    %CD%\%guard_dir%\winsw.exe install &gt;nul 2&gt;nul</code></pre>
<h4 id="2.3.2">2. 开启服务</h4>
<pre><code class="lang-cmd"> %net% start %updaemon_vc% &gt;nul 2&gt;nul</code></pre>
<h4 id="2.3.3">3. 判断进程</h4>
<pre><code class="lang-cmd">  tasklist|findstr /i updaemon.exe &gt;nul 2&gt;nul &amp;&amp; goto start_U_OK || goto start_U_ERROR</code></pre>
<h4 id="2.3.4">4. 卸载</h4>
<pre><code class="lang-cmd">    :: 根据服务名称kill
    %taskkill% /fi &quot;SERVICES eq %updaemon_vc%&quot; /f /t &gt;nul 2&gt;nul
    :: 卸载服务
    %CD%\%guard_dir%\winsw.exe uninstall &gt;nul 2&gt;nul</code></pre>
<h4 id="2.3.5">5. 详解</h4>
<p>守护进程项目名称 “Windows Service Wrapper”,配置文件：</p>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;service&gt;
&lt;id&gt;UPUPW_updaemon_A&lt;/id&gt;
&lt;name&gt;UPUPW_updaemon_A&lt;/name&gt;
&lt;description&gt;用于支持Apache守护进程随服务启动&lt;/description&gt;
&lt;executable&gt;E:/upupw/upcore/updaemon.exe&lt;/executable&gt;
&lt;logpath&gt;E:/upupw/Guard/&lt;/logpath&gt;
&lt;logmode&gt;roll&lt;/logmode&gt;
&lt;depend&gt;&lt;/depend&gt;
&lt;startargument&gt;-p E:/upupw/upcore/updaemon.exe&lt;/startargument&gt;
&lt;stopargument&gt;&lt;/stopargument&gt;
&lt;/service&gt;</code></pre>
<h3 id="2.4">4. 程序控制</h3>
<h4 id="2.4.1">apache 相关</h4>
<ul>
<li>初始化配置文件</li>
</ul>
<pre><code class="lang-cmd">    :: 执行外部程序，调用upcfg(),为 false 跳转至菜单栏
    set php=%upcore_dir%\upcore.exe -d extension_dir=%upcore_dir% -d date.timezone=UTC -n %upcore_dir%\up.dll
    %php% upcfg(); || %pause% &amp;&amp; goto menu</code></pre>
<ul>
<li>安装,指定生成的服务名称</li>
</ul>
<pre><code class="lang-cmd">
:: 安装apache应用，将结果重定向到nul
c:\wamp\apche\bin\httpd.exe -k install -n &quot;Apache Server&quot; &gt;nul 2&gt;nul</code></pre>
<ul>
<li>开启</li>
</ul>
<pre><code class="lang-cmd">:: 启动apache应用，
c:\wamp\apche\bin\httpd.exe -k start -n &quot;Apache Server&quot; &gt;nul 2&gt;nul</code></pre>
<h4 id="2.4.2">mysql 相关</h4>
<ul>
<li>安装成系统服务</li>
</ul>
<pre><code class="lang-cmd">    %CD%\%database_dir%\bin\mysqld.exe --install &quot;Mysql Server&quot; --defaults-file=&quot;%CD%\%database_dir%\my.ini&quot; &gt;nul 2&gt;nul</code></pre>
<ul>
<li>启动服务</li>
</ul>
<pre><code class="lang-cmd">     %net% start &quot;Mysql Server&quot;</code></pre>
<ul>
<li>判断进程</li>
</ul>
<pre><code class="lang-cmd"> tasklist|findstr /i mysqld.exe &gt;nul 2&gt;nul &amp;&amp; goto start_M_OK || goto start_M_ERROR</code></pre>
<h4 id="2.4.3">redis 相关</h4>
<ul>
<li>安装成系统服务</li>
</ul>
<pre><code class="lang-cmd">     %CD%\%redis_dir%\redis-server.exe --service-install %CD%\%redis_conf% --service-name %redis_vc% &gt;nul 2&gt;nul</code></pre>
<ul>
<li>启动服务</li>
</ul>
<pre><code class="lang-cmd">      %CD%\%redis_dir%\redis-server.exe --service-start --service-name %redis_vc% &gt;nul 2&gt;nul</code></pre>
<ul>
<li>判断进程<pre><code class="lang-cmd">tasklist|findstr /i redis-server.exe &gt;nul 2&gt;nul &amp;&amp; goto start_C_OK || goto start_C_ERROR</code></pre>
</li>
</ul>
<h4 id="2.4.4">nginx 相关</h4>
<ul>
<li>nginx 并无默认安装服务方式，</li>
</ul>
<blockquote>
<p>使用了“Windows Service Wrapper”，配置文件如下：</p>
</blockquote>
<pre><code class="lang-xml">&lt;!-- php 部分 --&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;service&gt;  
&lt;id&gt;UPUPW_PHPFPM&lt;/id&gt;  
&lt;name&gt;UPUPW_PHPFPM&lt;/name&gt;  
&lt;description&gt;用于支持PHP-FastCGI随服务启动&lt;/description&gt;  
&lt;executable&gt;X:/upupw/PHP7/phpfpm.exe&lt;/executable&gt; 
&lt;logpath&gt;X:/upupw/PHP7/phpfpm/&lt;/logpath&gt; 
&lt;logmode&gt;roll&lt;/logmode&gt; 
&lt;depend&gt;&lt;/depend&gt;  
&lt;startargument&gt;&quot;X:/upupw/PHP7/php-cgi.exe -c X:/upupw/PHP7/php.ini&quot; -n 8 -i 127.0.0.1 -p 9070&lt;/startargument&gt;
&lt;stopargument&gt;&lt;/stopargument&gt;
&lt;/service&gt;</code></pre>
<pre><code class="lang-xml">
&lt;!-- nginx 部分 --&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;service&gt;  
&lt;id&gt;UPUPW_Nginx&lt;/id&gt;
&lt;name&gt;UPUPW_Nginx&lt;/name&gt;
&lt;description&gt;用于支持Nginx随服务启动&lt;/description&gt;
&lt;executable&gt;X:/upupw/Nginx/nginx.exe&lt;/executable&gt;
&lt;logpath&gt;X:/upupw/Nginx/&lt;/logpath&gt;
&lt;logmode&gt;roll&lt;/logmode&gt;
&lt;depend&gt;&lt;/depend&gt;
&lt;startargument&gt;-p X:/upupw/Nginx&lt;/startargument&gt;
&lt;stopargument&gt;-p X:/upupw/Nginx -s stop&lt;/stopargument&gt;
&lt;/service&gt;</code></pre>
<ul>
<li>安装服务、启动服务（先起php，后起 nginx）</li>
</ul>
<pre><code class="lang-cmd">:: 初始化配置文件
%php% upcfg(); || %pause% &amp;&amp; goto menu
:: 安装php服务，
%CD%\%phpfpm%\winsw.exe install &gt;nul 2&gt;nul
:: 启动服务
%net% start %cgi_vc% &gt;nul 2&gt;nul
:: 验证进程
tasklist|findstr /i phpfpm.exe &gt;nul 2&gt;nul &amp;&amp; goto start_FPM_OK || goto start_FPM_ERROR

:: 安装nginx服务
%CD%\%nginx_dir%\winsw.exe install &gt;nul 2&gt;nul
:: 启动nginx服务
%net% start %nginx_vc% &gt;nul 2&gt;nul
:: 根据pid文件验证服务是否已启动
if exist %CD%\%nginx_dir%\logs\*.pid goto start_N_OK</code></pre>
<ul>
<li>停止服务
```cmd</li>
</ul>
<p>:: 停止nginx服务
%net% stop %nginx_vc% &gt;nul 2&gt;nul</p>
<p>:: kill nginx，php 服务
%taskkill% /fi &quot;SERVICES eq %nginx_vc%&quot; /f /t &gt;nul 2&gt;nul
%taskkill% /fi &quot;SERVICES eq %cgi_vc%&quot; /f /t &gt;nul 2&gt;nul</p>
<p>:: 卸载nginx，php 服务
%CD%\%nginx_dir%\winsw.exe uninstall &gt;nul 2&gt;nul
%CD%\%phpfpm%\winsw.exe uninstall &gt;nul 2&gt;nul</p>
<p>:: kill php进程，删除pid文件
%taskkill% /im phpfpm.exe /f /t&gt;nul 2&gt;nul
%taskkill% /im php-cgi.exe /f /t&gt;nul 2&gt;nul
del /f/s/q %CD%\%nginx_dir%\logs*.pid /q&gt;nul 2&gt;nul</p>
<pre><code>
- 配置文件模版
```config

server {
            # 监听端口
            listen       &#39; . $port . &#39;; 
            # 域名 和 别名
            server_name  &#39; . $hn . &#39; alias &#39; . $hAlias . &#39;;
            location / {
                root   &#39; . $htdocs . &#39;;
                index  index.html index.htm default.html default.htm index.php default.php app.php u.php;
                include        &#39; . $htdocs . &#39;/up-*.conf;
            }
            autoindex off;
            include advanced_settings.conf;
            #include expires.conf;
            location ~* .*\/(attachment|attachments|uploadfiles|avatar)\/.*\.(php|PHP7|phps|asp|aspx|jsp)$ {
            deny all;
            }
            location ~ ^.+\.php {
                root           &#39; . $htdocs . &#39;;
                fastcgi_pass   bakend;
                fastcgi_index  index.php;
                fastcgi_split_path_info ^((?U).+\.php)(/?.+)$;
                fastcgi_param  PATH_INFO $fastcgi_path_info;
                fastcgi_param  PATH_TRANSLATED $document_root$fastcgi_path_info;
                include        fastcgi.conf;
            }
        }

##server &#39; . $hn . &#39; end}</code></pre>
<h4 id="2.4.5">php 相关</h4>
<h4 id="2.4.6">FTP 相关</h4>

<h2 id="3">FFMPEG 音视频处理</h2>
<p><a href="http://elkpi.com/topics/ffmpeg-f-hls.html">http://elkpi.com/topics/ffmpeg-f-hls.html</a></p>
<h3 id="3.1">常用测试源</h3>
<pre><code class="lang-cmd">// 香港
rtmp://live.hkstv.hk.lxdns.com/live/hks

// 香港
http://live.hkstv.hk.lxdns.com/live/hks/playlist.m3u8


// 亚太第一卫视 
rtmp://v1.one-tv.com/live/mpegts.stream

// apple 测试
http://devimages.apple.com.edgekey.net/streaming/examples/bipbop_4x3/gear2/prog_index.m3u8

// 大熊兔（点播）：
rtsp://184.72.239.149/vod/mp4://BigBuckBunny_175k.mov

// CCTV5+高清
http://ivi.bupt.edu.cn/hls/cctv5phd.m3u8</code></pre>
<h3 id="3.2">常用命令:</h3>
<h4 id="3.2.1">1. 将视频流推送到流媒体服务器</h4>
<pre><code class="lang-bash">ffmpeg -i rtmp://live.hkstv.hk.lxdns.com/live/hks -c:a copy -c:v copy -f flv rtmp://192.168.17.229:5080/oflaDemo/2</code></pre>
<h4 id="3.2.2">2. 视频文件转MP4</h4>
<pre><code class="lang-bash"># 视频编码转H264,音频编码转aac，文件格式转MP4
ffmpeg -threads {$threads} -i {$old_video} -preset:v ultrafast -tune zerolatency -codec:v h264 -codec:a aac -strict -2 -y {$new_video};

# 文件格式转MP4
ffmpeg -threads {$threads} -i {$old_video} -vcodec copy -acodec copy -y {$new_video} ;

# 音频编码转aac，文件格式转MP4
ffmpeg -threads {$threads} -i {$old_video} -vcodec copy -acodec aac -strict -2 -y {$new_video} ;

# copy 
ffmpeg -i {$input} -c:a copy -c:v copy -f flv {$out} ;</code></pre>
<h4 id="3.2.3">3. 修改文件创建时间</h4>
<pre><code class="lang-php">ffmpeg.exe -i 6.mp4 -metadata creation_time=&quot;2013-06-22 15:00:00&quot; -acodec copy -vcodec copy output.mp4</code></pre>
<h4 id="3.2.4">转成mp4</h4>
<p>转码mp4（资源占用很高，允许15个转码 300M*15 = 45000M）</p>
<pre><code class="lang-bash">/home/webserver/server/ffmpeg -threads 8 -i /root/Desktop/name.mp4 \
-r 25 -map 0 -codec:v h264 -b 500k -maxrate 50k -s 1280x720 \
-codec:a aac -strict -2 -ar 44100 -ab 96k \
-y output.mp4</code></pre>
<h4 id="3.2.5">ssegment点播</h4>
<p>点播切片（资源低，无需限制，可以多线程统一处理已转码视频）</p>
<pre><code class="lang-bash">/home/webserver/server/ffmpeg -threads 8 -i output.mp4 \
-map 0 -codec:v copy -bsf:v h264_mp4toannexb -codec:a copy \
-f ssegment -segment_format mpegts -segment_list video_1.m3u8 -segment_time 15 video_1_%04d.ts</code></pre>
<h4 id="3.2.6">ssegment直播（没找到参数只保留一个文件）</h4>
<pre><code class="lang-bash">/home/webserver/server/ffmpeg -threads 8 -re -i /root/Desktop/name.mp4 \
-profile:v baseline -level 3.0 -tune zerolatency \
-r 25 -map 0 -codec:v h264 -b 500k -maxrate 50k -s 1280x720 \
-codec:a aac -strict -2 -ar 44100 -ab 96k \
-f ssegment -segment_format mpegts -segment_list_flags +live \
-segment_list video_1.m3u8 -segment_time 5 -segment_list_size 1 -segment_size 1 video_1_%04d.ts</code></pre>
<h4 id="3.2.7">hls转播</h4>
<p>转播（资源占用较低，允许40个转播120M*40 = 4800M内存）</p>
<pre><code class="lang-bash">/home/webserver/server/ffmpeg -threads 8 -re -i /root/Desktop/name.mp4 \
-profile:v baseline -level 3.0 -tune zerolatency \
-r 25 -map 0 -codec:v h264 -b 500k -maxrate 50k -s 1280x720 \
-codec:a aac -strict -2 -ar 44100 -ab 96k \
-f hls -hls_list_size 1 -hls_time 5 -hls_wrap 1 -start_number 1 video_1.m3u8</code></pre>

<h2 id="4">Git 版本库</h2>
<h3 id="4.1">0. 初始化</h3>
<pre><code> # 创建项目 
 mkdir paperless
 cd paperless
 git init
 echo &quot;# paperless&quot; &gt;&gt; README.md
 git add README.md
 git commit -m &quot;first commit&quot;
 git remote add origin https://git.coding.net/penguinseven/paperless.git
 git push -u origin master

 ## 已有项目
 git remote add origin https://git.coding.net/penguinseven/paperless.git
 git push -u origin master</code></pre>
<h3 id="4.2">1.  保存用户名，密码</h3>
<p>每次操作都需要输入用户名和密码感觉很繁琐，解决方法，在本地的工程文件夹的.git下打开config文件
添加：(再输入一次用户名密码后就可以保存住了。)</p>
<pre><code class="lang-cmd">    [credential]
         helper = store</code></pre>
<h3 id="4.3">2. 修改git 源</h3>
<pre><code class="lang-cmd">git remote set-url origin/master http://xxx</code></pre>
<h3 id="4.4">3.tag标签</h3>
<blockquote>
<p>Git 中的tag指向一次commit的id，通常用来给开发分支做一个标记，如标记一个版本号。</p>
</blockquote>
<h4 id="4.4.1">1. 打标签</h4>
<pre><code>git tag -a v1.01 -m &quot;Relase version 1.01&quot;</code></pre>
<blockquote>
<p>注解：git tag 是打标签的命令，-a 是添加标签，其后要跟新标签号，-m 及后面的字符串是对该标签的注释。</p>
</blockquote>
<h4 id="4.4.2">2. 提交标签到远程仓库</h4>
<pre><code>git push origin -tags</code></pre>
<blockquote>
<p>注解：就像git push origin master 把本地修改提交到远程仓库一样，-tags可以把本地的打的标签全部提交到远程仓库。</p>
</blockquote>
<h4 id="4.4.3">3. 删除标签</h4>
<pre><code>git tag -d v1.01</code></pre>
<blockquote>
<p>注解：-d 表示删除，后面跟要删除的tag名字</p>
</blockquote>
<h4 id="4.4.4">4. 删除远程标签</h4>
<pre><code>git push origin :refs/tags/v1.01</code></pre>
<blockquote>
<p>注解：就像git push origin :branch_1 可以删除远程仓库的分支branch_1一样， 冒号前为空表示删除远程仓库的tag。</p>
</blockquote>
<h4 id="4.4.5">5. 查看标签</h4>
<pre><code>git tag
# 或者  
git tag -l</code></pre>

<h2 id="5">HTML</h2>
<h3 id="5.1">常见问题</h3>
<h4 id="5.1.1">1. firfox 提示安装flash</h4>
<blockquote>
<p>（不能使用样式display:none）</p>
</blockquote>
<pre><code class="lang-html">&lt;!--flash--&gt;
    &lt;object type=&quot;application/x-shockwave-flash&quot; &gt;&lt;/object&gt;</code></pre>

<h2 id="6">JavaScript</h2>
<h3 id="6.1">常见问题</h3>
<h4 id="6.1.1">1. 百度云盘web下载大文件</h4>
<pre><code class="lang-javascript">window.navigator.__defineGetter__ (&#39;platform&#39;, function () {return &#39;&#39;});</code></pre>
<h4 id="6.1.2">2.浏览器复制</h4>
<pre><code class="lang-javascript">var reg = document.querySelector(&#39;.register-str&#39;);
    reg.select(); // 选中
    document.execCommand(&quot;Copy&quot;); // 执行浏览器复制命令</code></pre>

<h2 id="7">Mysql 数据库</h2>
<h3 id="7.1">常见问题</h3>
<h4 id="7.1.1">1. 修改权限</h4>
<pre><code class="lang-mysql">-- 赋予任何主机访问数据的权限
GRANT ALL RIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39; WITH GRANT OPTION</code></pre>
<h4 id="7.1.2">2. 结束符定义</h4>
<ul>
<li>总所周知，mysql的命令行执行每一条命令是以分号结尾的，也就是说识别是否为一条命令，是根据分号决定的。
然而存储过程中设计多条语句，很可能出现多个分号，所以直接把存储过程复制到命令号一般都会失败</li>
</ul>
<ul>
<li>解决方法是需要加一个分隔符，让命令行知道整个存储过程的代码是完整的一块代码,代码如下</li>
</ul>
<pre><code class="lang-mysql">DELIMITER //     
CREATE PROCEDURE p_name (IN b INTEGER(12))     
begin     
 declare a INTEGER(12);     
 set a=12;     
 INSERT INTO t VALUES (a);     
 SELECT s1* a FROM t;     
End     
//</code></pre>
<ul>
<li>如代码中所示，在存储过程的开头加上“DELIMITER //”,结尾加上“//”就ok了</li>
</ul>
<ul>
<li>执行后续的sql ，需将结束符重新定义</li>
</ul>
<pre><code class="lang-mysql">DELIMITER ;</code></pre>
<h4 id="7.1.3">3. ORDER BY 自定义规则</h4>
<blockquote>
<p>问题描述:<br>大家都知道, MySQL 中按某字段升序排列的 SQL 为 (以 id 为例, 下同):</p>
</blockquote>
<pre><code class="lang-mysql">
SELECT * FROM `MyTable` 
WHERE `id` IN (1, 7, 3, 5) 
ORDER BY `id` ASC</code></pre>
<p>降序排列的 SQL 为:</p>
<pre><code class="lang-mysql">SELECT * FROM `MyTable` 
WHERE `id` IN (1, 7, 3, 5) 
ORDER BY `id` DESC</code></pre>
<p>有时以上排序并不能满足我们的需求. 例如, 我们想要按 id 以 5, 3, 7, 1 的顺序排列, 该如何实现. 这也是很多国内外同行经常遇到的问题之一.</p>
<p>下面我们给出按表中某字段, 以我们想要的列表方式排序的解决方案.
解决方案用&quot;按字段排序&quot; (ORDER BY FIELD).语法:</p>
<pre><code class="lang-mysql">  SELECT * FROM MyTable 
  ORDER BY FIELD(`id`, 5, 3, 7, 1)</code></pre>
<p>要注意的是, FIELD 后面是没有空格的.
因此, 完整的 SQL 为:</p>
<pre><code class="lang-mysql">SELECT * FROM `MyTable` 
WHERE `id` IN (1, 7, 3, 5) 
ORDER BY FIELD(`id`, 5, 3, 7, 1)</code></pre>
<p>常见应用:</p>
<pre><code class="lang-mysql">SELECT * FROM `MyTable` 
WHERE `name` IN (&#39;张三&#39;, &#39;李四&#39;, &#39;王五&#39;, &#39;孙六&#39;) 
ORDER BY FIELD(`name`, &#39;李四&#39;, &#39;孙六&#39;, &#39;张三&#39;, &#39;王五&#39;)</code></pre>
<h4 id="7.1.4">4.查询字段和注释</h4>
<pre><code class="lang-mysql">  select COLUMN_NAME,column_comment 
  from INFORMATION_SCHEMA.Columns 
  where table_name=&#39;表名&#39; and table_schema=&#39;数据库&#39;</code></pre>
<h4 id="7.1.5">5.查询表结构</h4>
<pre><code class="lang-mysql">
SELECT a.table_name,b.TABLE_COMMENT,a.COLUMN_NAME,a.COLUMN_TYPE,a.COLUMN_COMMENT 
FROM information_schema.COLUMNS a 
JOIN information_schema.TABLES b ON a.table_schema = b.table_schema AND a.table_name = b.table_name
WHERE a.table_name = &#39;question&#39;;</code></pre>

<h1 id="-">常见问题</h1>

<h2 id="8">PHP</h2>
<h3 id="8.1">　常见问题</h3>
<h4 id="8.1.1">1. php-cli 模式，判断文件是否存在错误</h4>
<pre><code>clearstatcache()</code></pre>
<blockquote>
<p>clearstatcache() 函数会缓存某些函数的返回信息，
以便提供更高的性能。但是有时候，比如在一个脚本中多次检查同一个文件，
而该文件在此脚本执行期间有被删除或修改的危险时，你需要清除文件状态缓存，
以便获得正确的结果。要做到这一点，就需要使用 clearstatcache() 函数。
会进行缓存的函数，即受 clearstatcache() 函数影响的函数：</p>
</blockquote>
<pre><code class="lang-php">    stat()
    lstat()
    file_exists()
    is_writable()
    is_readable()
    is_executable()
    is_file()
    is_dir()
    is_link()
    filectime()
    fileatime()
    filemtime()
    fileinode()
    filegroup()
    fileowner()
    filesize()
    filetype()
    fileperms()</code></pre>
<p>example :</p>
<pre><code class="lang-php">&lt;?php
//检查文件大小
echo filesize(&quot;test.txt&quot;);

$file = fopen(&quot;test.txt&quot;, &quot;a+&quot;);

// 截取文件
ftruncate($file,100);
fclose($file);

//清除缓存并再次检查文件大小
clearstatcache();
echo filesize(&quot;test.txt&quot;);
?&gt;</code></pre>
<h4 id="8.1.2">2. PHP并行 多进程/多线程</h4>
<blockquote>
<p>PHP中提供了一个扩展pcntl，可以利用操作系统的fork调用来实现多进程。
fork调用后执行的代码将是并行的。</p>
</blockquote>
<p>注：pcntl仅支持linux平台，并且只能在cli模式下使用。</p>
<pre><code class="lang-php">    $pid = pcntl_fork();

    if($pid &gt; 0){

        //父进程代码

        exit(0);

    } elseif($pid == 0) {

        //子进程代码

        exit(0);

    }</code></pre>
<ol>
<li><p>此扩展仅在线程安全版本中可用,多线程扩展<a href="http://pecl.php.net/package/pthreads">http://pecl.php.net/package/pthreads</a></p>
</li>
<li><p>多进程和多线程其实是作用是相同的。区别是</p>
<ul>
<li>线程是在同一个进程内的，可以共享内存变量实现线程间通信</li>
<li>线程比进程更轻量级，开很大量进程会比线程消耗更多系统资源</li>
<li>多线程也存在一些问题：</li>
</ul>
</li>
<li><p>线程读写变量存在同步问题，需要加锁</p>
<ul>
<li>锁的粒度过大会有性能问题，可能会导致只有1个线程在运行，其他线程都在等待锁。这样就不是并行了</li>
<li>同时使用多个锁，逻辑复杂，一旦某个锁没被正确释放，可能会发生线程死锁</li>
<li>某个线程发生致命错误会导致整个进程崩溃</li>
</ul>
</li>
<li><p>多进程方式更加稳定，另外利用进程间通信（IPC）也可以实现数据共享。</p>
<ul>
<li>共享内存，这种方式和线程间读写变量是一样的，需要加锁，会有同步、死锁问题。</li>
<li>消息队列，可以采用多个子进程抢队列模式，性能很好</li>
<li>PIPE，UnixSock，TCP，UDP。可以使用read/write来传递数据，TCP/UDP方式使用socket来通信，子进程可以分布运行<h4 id="8.1.3">3. composer</h4>
</li>
</ul>
</li>
</ol>
<pre><code class="lang-shell">curl -sS https://getcomposer.org/installer | php
mv composer.phar /usr/local/bin/composer</code></pre>
<h4 id="8.1.4">4. phpunit</h4>
<pre><code>composer global require phpunit/phpunit</code></pre>
<p>全局安装PHPUnit。<br>然后在~/.bashrc文件末尾加一行PATH=$PATH:/home/feng/.composer/vendor/bin  （注意替换用户名），来将Composer的global bin目录加入PATH。</p>

<h2 id="9">Tool 常用工具</h2>

<h3 id="9.1">inno setup 常见问题</h3>
<h4 id="9.1.1">1. 系统管理员运行</h4>
<blockquote>
<p>Inno Setup打包的程序安装完成后运行失败，
    这个是因为权限不够，我们可以通过下面的办法解决：
  找到Inno Setup安装目录下的SetupLdr.e32文件，
  然后用Resource Hacker软件打开，将Manifest改成</p>
</blockquote>
<pre><code>&lt;requestedExecutionLevel level=&quot;requireAdministrator&quot;  uiAccess=&quot;false&quot;/&gt;</code></pre>
<p>然后保存，就行啦。</p>
<h4 id="9.1.2">2. 添加程序到右键</h4>
<pre><code class="lang-bash">[Registry]
Root: HKCR; Subkey: &quot;*\shell\Open with Notepad\command&quot;; ValueType: string; ValueName: &quot;&quot;; ValueData: &quot;{app}\notepad\notepad++.exe %1&quot;;   Flags: deletekey uninsdeletekey;</code></pre>
<h4 id="9.1.3">3.开机启动</h4>
<pre><code class="lang-bash">[Registry]
Root: HKLM; Subkey: &quot;SOFTWARE\Microsoft\Windows\CurrentVersion\Run&quot;; ValueType: string; ValueName: &quot;paperless&quot;; ValueData: &quot;{app}\{#MyAppExeName}&quot;; Flags: deletekey uninsdeletekey;</code></pre>
<h3 id="9.2">4.判断进程是否正在运行</h3>
<pre><code>[Code]

function IsModuleLoaded(modulename: AnsiString ):  Boolean;
external &#39;IsModuleLoaded@files:psvince.dll stdcall&#39;;

var
Page: TWizardPage;
RadioButton1, RadioButton2: TRadioButton;
Lbl1, Lbl2: TNewStaticText;
TaskCode: Boolean;

// PSVince控件在64位系统（Windows 7/Server 2008/Server 2012）下无法检测到进程，使用下面的函数可以解决。
function IsAppRunning(const FileName : string): Boolean;
var
    FSWbemLocator: Variant;
    FWMIService   : Variant;
    FWbemObjectSet: Variant;
begin
    Result := false;
    try
      FSWbemLocator := CreateOleObject(&#39;WBEMScripting.SWBEMLocator&#39;);
      FWMIService := FSWbemLocator.ConnectServer(&#39;&#39;, &#39;root\CIMV2&#39;, &#39;&#39;, &#39;&#39;);
      FWbemObjectSet := FWMIService.ExecQuery(Format(&#39;SELECT Name FROM Win32_Process Where Name=&quot;%s&quot;&#39;,[FileName]));
      Result := (FWbemObjectSet.Count &gt; 0);
      FWbemObjectSet := Unassigned;
      FWMIService := Unassigned;
      FSWbemLocator := Unassigned;
    except
      if (IsModuleLoaded(FileName)) then
        begin
          Result := false;
        end
      else
        begin
          Result := true;
        end
      end;
end;</code></pre>
<h3 id="9.3">5. 判断安装 “.net 4.0”</h3>
<pre><code>#define IncludeFramework true  


[Files]
#if IncludeFramework
Source: &quot;E:\无纸化会议客户端\ext\dotNetFx40_Full_x86_x64.exe&quot;; DestDir: &quot;{tmp}&quot;; Flags: ignoreversion {#IsExternal}; Check: NeedsFramework
#endif  

[Run]
#if IncludeFramework
Filename: {tmp}\dotNetFx40_Full_x86_x64.exe; Parameters: &quot;/q:a /c:&quot;&quot;install /l /q&quot;&quot;&quot;; WorkingDir: {tmp}; Flags: skipifdoesntexist; StatusMsg: &quot;Installing .NET Framework if needed&quot;
#endif


[code]

// Indicates whether .NET Framework 2.0 is installed.
function IsDotNET40Detected(): boolean;
var
    success: boolean;
    install: cardinal;
begin
    success := RegQueryDWordValue(HKLM, &#39;SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full&#39;, &#39;Install&#39;, install);
     //success := RegQueryDWordValue(HKLM, &#39;SOFTWARE\Microsoft\NET Framework Setup\NDP\v2.0.50727&#39;, &#39;Install&#39;, install);
    Result :=  success and (install = 1);
end;

//RETURNS OPPOSITE OF IsDotNet20Detected FUNCTION
//Remember this method from the Files section above
function NeedsFramework(): Boolean;
begin
  Result := (IsDotNET40Detected = false);
end;

function GetCustomSetupExitCode(): Integer;
begin
  if (IsDotNET40Detected = false) then
    begin
      MsgBox(&#39;.NET Framework 未能正确安装!&#39;,mbError, MB_OK);
      result := -1
    end
end;</code></pre>

<h3 id="9.4">winsw  常见问题</h3>
<h4 id="9.4.1">1. 安装服务</h4>
<pre><code class="lang-cmd">winsw.exe install</code></pre>
<h4 id="9.4.2">2. 卸载服务</h4>
<pre><code class="lang-cmd">winsw.exe uninstall</code></pre>
<h4 id="9.4.3">3. 使用示例</h4>
<ol>
<li><p>下载最新版的 Windows Service Wrapper 程序，比如我下载的名称是 &quot;winsw-1.9-bin.exe&quot;，
 然后，把它命名成你想要的名字（比如: &quot;myapp.exe&quot;，当然，你也可以不改名）</p>
</li>
<li><p>将重命名后的 myapp.exe 复制到 nginx 的安装目录（我这里是 &quot;F:\nginx-0.9.4&quot;）</p>
</li>
<li><p>在同一个目录下创建一个Windows Service Wrapper的XML配置文件，名称必须与第一步重命名时使用的名称一致（比如我这里是 &quot;myapp.xml&quot;,  如果，你没有重命名，则应该是 &quot;winsw-1.9-bin.xml&quot;）
文件内容如下：</p>
</li>
</ol>
<pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;service&gt;
  &lt;id&gt;nginx&lt;/id&gt;
  &lt;name&gt;nginx&lt;/name&gt;
  &lt;description&gt;nginx&lt;/description&gt;
  &lt;executable&gt;F:\nginx-0.9.4\nginx.exe&lt;/executable&gt;
  &lt;logpath&gt;F:\nginx-0.9.4\&lt;/logpath&gt;
  &lt;logmode&gt;roll&lt;/logmode&gt;
  &lt;depend&gt;&lt;/depend&gt;
  &lt;startargument&gt;-p F:\nginx-0.9.4&lt;/startargument&gt;
  &lt;stopargument&gt;-p F:\nginx-0.9.4 -s stop&lt;/stopargument&gt;
&lt;/service&gt;</code></pre>
<ol>
<li>命令行下执行以下命令，以便将其安装成Windows服务</li>
</ol>
<pre><code class="lang-cmd">F:\nginx-0.9.4&gt; myapp.exe install</code></pre>





<h2 id="10">综合 &gt;&gt;&gt;&gt;</h2>
<h2 id="11">1. 开发 larvael + vue 项目</h2>
<h2 id="12">2. workman 知识点总结</h2>
<ul>
<li><h3 id="12.1">常用名词解释</h3>
<ol>
<li><p>并发连接数  </p>
<p> 并发连接数是指服务器当前时刻一共维持了多少TCP连接，
 而这些连接上是否有数据通讯并不关注，
 例如一台消息推送服务器上可能维持了百万的设备连接，
 由于连接上很少有数据通讯，所以这台服务器上负载可能几乎为0，
 只要内存足够，还可以继续接受连接。</p>
<p> 并发连接数受限于服务器内存，
 一般24G内存workerman服务器可以支持大概120W并发连接。</p>
</li>
<li><p>并发请求数</p>
<p> 并发请求数一般用QPS（服务器每秒处理多少请求）来衡量，
 而当前时刻服务器上有多少个tcp连接并不十分关注。
 例如一台服务器只有10个客户端连接，
 每个客户端连接上每秒有1W个请求，
 那么要求服务端需要至少能支撑10*1W=10W每秒的吞吐量（QPS）。
 假设10W吞吐量每秒是这台服务器的极限，
 如果每个客户端每秒发送1个请求给服务端，
 那么这台服务器能够支撑10W个客户端。</p>
<p> 并发请求数受限于服务器cpu处理能力，
 一台24核workerman服务器可以达到45W每秒的吞吐量(QPS)，
 实际值根据业务复杂度以及代码质量有所变化。</p>
</li>
<li><p>非阻塞</p>
</li>
<li><p>异步</p>
</li>
</ol>
</li>
</ul>
<ul>
<li><h3 id="12.2">ReactPHP相关</h3>
<ol>
<li>react/mysql</li>
<li>react/redis</li>
<li>react/dns  </li>
<li>react/http-client        http 组件</li>
<li>react/zmp &amp;&amp; react/stomp 异步消息队列</li>
<li>react/child-process      进程控制组件</li>
</ol>
</li>
</ul>
<h2 id="13">3. electron 项目</h2>
<h2 id="14">4. upupw 知识点总结</h2>
<ul>
<li><h3 id="14.1">apache 优化配置</h3>
</li>
<li><h3 id="14.2">nginx 优化配置</h3>
</li>
<li><h3 id="14.3">php 优化配置</h3>
</li>
</ul>
<h2 id="15">5. Linux shell 脚本</h2>
<ul>
<li><h3 id="15.1">nginx-rtmp</h3>
</li>
</ul>
<h2 id="16">6. Python 开发</h2>
<h2 id="17">7. 流媒体服务器</h2>
<h3 id="17.1">协议选择</h3>
<pre><code>延迟要求，是否要求低于5秒的延迟?如果是硬指标，
就只能选择RTMP或HTTP-FLV流。移动端需要自己编译FFMPEG支持，无法直接播放。

终端适配，是否要求支持PC和移动端(IOS和Android)?
如果需要广泛支持移动端，HLS是最好的选择。

节约带宽，是否要求支持WebP2P?如果需要支持FlashP2P，
或者移动端P2P，选择HLS。</code></pre>
<ul>
<li><h3 id="17.2">nginx-rtmp</h3>
</li>
<li><h3 id="17.3">red5</h3>
</li>
<li><h3 id="17.4">simple rtmp server</h3>
</li>
</ul>

</article>
<footer>

</footer>
