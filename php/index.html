<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PHP | 吧食笔记</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/PenguinSeven/logo.png">
    <meta name="description" content="PenguinSeven">
    
    <link rel="preload" href="/PenguinSeven/assets/css/0.styles.feb1df48.css" as="style"><link rel="preload" href="/PenguinSeven/assets/js/app.e3215620.js" as="script"><link rel="preload" href="/PenguinSeven/assets/js/2.f28e70e0.js" as="script"><link rel="preload" href="/PenguinSeven/assets/js/1.bb87e0ea.js" as="script"><link rel="preload" href="/PenguinSeven/assets/js/75.f13216e5.js" as="script"><link rel="prefetch" href="/PenguinSeven/assets/js/10.e38c7cc5.js"><link rel="prefetch" href="/PenguinSeven/assets/js/100.b70b0c1d.js"><link rel="prefetch" href="/PenguinSeven/assets/js/101.46e03238.js"><link rel="prefetch" href="/PenguinSeven/assets/js/102.afb17aab.js"><link rel="prefetch" href="/PenguinSeven/assets/js/103.5348c87b.js"><link rel="prefetch" href="/PenguinSeven/assets/js/104.371c6a10.js"><link rel="prefetch" href="/PenguinSeven/assets/js/105.4f5114fb.js"><link rel="prefetch" href="/PenguinSeven/assets/js/106.81e257bc.js"><link rel="prefetch" href="/PenguinSeven/assets/js/107.2d52361a.js"><link rel="prefetch" href="/PenguinSeven/assets/js/108.0a9f9e46.js"><link rel="prefetch" href="/PenguinSeven/assets/js/109.f551f328.js"><link rel="prefetch" href="/PenguinSeven/assets/js/11.d23c0f5a.js"><link rel="prefetch" href="/PenguinSeven/assets/js/110.b52cd7c6.js"><link rel="prefetch" href="/PenguinSeven/assets/js/111.d5335226.js"><link rel="prefetch" href="/PenguinSeven/assets/js/112.7b7ca9b6.js"><link rel="prefetch" href="/PenguinSeven/assets/js/12.3a7a7e61.js"><link rel="prefetch" href="/PenguinSeven/assets/js/13.f6d05845.js"><link rel="prefetch" href="/PenguinSeven/assets/js/14.63be2d10.js"><link rel="prefetch" href="/PenguinSeven/assets/js/15.3b9d1f7c.js"><link rel="prefetch" href="/PenguinSeven/assets/js/16.b49954cb.js"><link rel="prefetch" href="/PenguinSeven/assets/js/17.3deef2af.js"><link rel="prefetch" href="/PenguinSeven/assets/js/18.4f4038bf.js"><link rel="prefetch" href="/PenguinSeven/assets/js/19.bd01e132.js"><link rel="prefetch" href="/PenguinSeven/assets/js/20.e3c1893e.js"><link rel="prefetch" href="/PenguinSeven/assets/js/21.4ecc4e24.js"><link rel="prefetch" href="/PenguinSeven/assets/js/22.975c1339.js"><link rel="prefetch" href="/PenguinSeven/assets/js/23.f9092028.js"><link rel="prefetch" href="/PenguinSeven/assets/js/24.65a37d34.js"><link rel="prefetch" href="/PenguinSeven/assets/js/25.4f168d23.js"><link rel="prefetch" href="/PenguinSeven/assets/js/26.6ebf9591.js"><link rel="prefetch" href="/PenguinSeven/assets/js/27.46f57b22.js"><link rel="prefetch" href="/PenguinSeven/assets/js/28.360dc145.js"><link rel="prefetch" href="/PenguinSeven/assets/js/29.f3679f2e.js"><link rel="prefetch" href="/PenguinSeven/assets/js/3.0d8eae40.js"><link rel="prefetch" href="/PenguinSeven/assets/js/30.e24d60db.js"><link rel="prefetch" href="/PenguinSeven/assets/js/31.f4d3a4bd.js"><link rel="prefetch" href="/PenguinSeven/assets/js/32.e2ddafd1.js"><link rel="prefetch" href="/PenguinSeven/assets/js/33.bf9f99d7.js"><link rel="prefetch" href="/PenguinSeven/assets/js/34.00a519cd.js"><link rel="prefetch" href="/PenguinSeven/assets/js/35.247ccef2.js"><link rel="prefetch" href="/PenguinSeven/assets/js/36.8d4c5896.js"><link rel="prefetch" href="/PenguinSeven/assets/js/37.c03673d9.js"><link rel="prefetch" href="/PenguinSeven/assets/js/38.67c7b36c.js"><link rel="prefetch" href="/PenguinSeven/assets/js/39.54af282a.js"><link rel="prefetch" href="/PenguinSeven/assets/js/4.4f963454.js"><link rel="prefetch" href="/PenguinSeven/assets/js/40.39f51a65.js"><link rel="prefetch" href="/PenguinSeven/assets/js/41.b02d0f12.js"><link rel="prefetch" href="/PenguinSeven/assets/js/42.9677d4ba.js"><link rel="prefetch" href="/PenguinSeven/assets/js/43.797fc167.js"><link rel="prefetch" href="/PenguinSeven/assets/js/44.2f858289.js"><link rel="prefetch" href="/PenguinSeven/assets/js/45.21f963f9.js"><link rel="prefetch" href="/PenguinSeven/assets/js/46.d2e1ca98.js"><link rel="prefetch" href="/PenguinSeven/assets/js/47.1fc82df1.js"><link rel="prefetch" href="/PenguinSeven/assets/js/48.687fabe4.js"><link rel="prefetch" href="/PenguinSeven/assets/js/49.90287b33.js"><link rel="prefetch" href="/PenguinSeven/assets/js/5.5cd94255.js"><link rel="prefetch" href="/PenguinSeven/assets/js/50.d76159f1.js"><link rel="prefetch" href="/PenguinSeven/assets/js/51.6b1fa08c.js"><link rel="prefetch" href="/PenguinSeven/assets/js/52.58a76040.js"><link rel="prefetch" href="/PenguinSeven/assets/js/53.9125e656.js"><link rel="prefetch" href="/PenguinSeven/assets/js/54.d6cd8701.js"><link rel="prefetch" href="/PenguinSeven/assets/js/55.2b73ef53.js"><link rel="prefetch" href="/PenguinSeven/assets/js/56.d1a4d4ef.js"><link rel="prefetch" href="/PenguinSeven/assets/js/57.5169ebe6.js"><link rel="prefetch" href="/PenguinSeven/assets/js/58.96d66609.js"><link rel="prefetch" href="/PenguinSeven/assets/js/59.633d7c58.js"><link rel="prefetch" href="/PenguinSeven/assets/js/6.918d102d.js"><link rel="prefetch" href="/PenguinSeven/assets/js/60.8d613e6e.js"><link rel="prefetch" href="/PenguinSeven/assets/js/61.db56d273.js"><link rel="prefetch" href="/PenguinSeven/assets/js/62.e2b462bb.js"><link rel="prefetch" href="/PenguinSeven/assets/js/63.7c3ce34b.js"><link rel="prefetch" href="/PenguinSeven/assets/js/64.1a097e05.js"><link rel="prefetch" href="/PenguinSeven/assets/js/65.44802131.js"><link rel="prefetch" href="/PenguinSeven/assets/js/66.d78e8844.js"><link rel="prefetch" href="/PenguinSeven/assets/js/67.d989226d.js"><link rel="prefetch" href="/PenguinSeven/assets/js/68.242e964f.js"><link rel="prefetch" href="/PenguinSeven/assets/js/69.ef773bc6.js"><link rel="prefetch" href="/PenguinSeven/assets/js/7.47f27853.js"><link rel="prefetch" href="/PenguinSeven/assets/js/70.daca4893.js"><link rel="prefetch" href="/PenguinSeven/assets/js/71.0b6d7d7b.js"><link rel="prefetch" href="/PenguinSeven/assets/js/72.bc8fe803.js"><link rel="prefetch" href="/PenguinSeven/assets/js/73.27a5bd45.js"><link rel="prefetch" href="/PenguinSeven/assets/js/74.7aa33133.js"><link rel="prefetch" href="/PenguinSeven/assets/js/76.2712ab88.js"><link rel="prefetch" href="/PenguinSeven/assets/js/77.54f1d586.js"><link rel="prefetch" href="/PenguinSeven/assets/js/78.b918de51.js"><link rel="prefetch" href="/PenguinSeven/assets/js/79.5b87455d.js"><link rel="prefetch" href="/PenguinSeven/assets/js/80.5321e22d.js"><link rel="prefetch" href="/PenguinSeven/assets/js/81.2a3f8b93.js"><link rel="prefetch" href="/PenguinSeven/assets/js/82.ba00d0a5.js"><link rel="prefetch" href="/PenguinSeven/assets/js/83.dd2cb066.js"><link rel="prefetch" href="/PenguinSeven/assets/js/84.491c2935.js"><link rel="prefetch" href="/PenguinSeven/assets/js/85.551da03a.js"><link rel="prefetch" href="/PenguinSeven/assets/js/86.eef7090f.js"><link rel="prefetch" href="/PenguinSeven/assets/js/87.74cc46a5.js"><link rel="prefetch" href="/PenguinSeven/assets/js/88.f8550254.js"><link rel="prefetch" href="/PenguinSeven/assets/js/89.0006922c.js"><link rel="prefetch" href="/PenguinSeven/assets/js/90.04cabd76.js"><link rel="prefetch" href="/PenguinSeven/assets/js/91.b4615aee.js"><link rel="prefetch" href="/PenguinSeven/assets/js/92.10bd2dd0.js"><link rel="prefetch" href="/PenguinSeven/assets/js/93.d0f1d208.js"><link rel="prefetch" href="/PenguinSeven/assets/js/94.0016cb12.js"><link rel="prefetch" href="/PenguinSeven/assets/js/95.f72d4f1c.js"><link rel="prefetch" href="/PenguinSeven/assets/js/96.95139868.js"><link rel="prefetch" href="/PenguinSeven/assets/js/97.676935b9.js"><link rel="prefetch" href="/PenguinSeven/assets/js/98.7d6a2012.js"><link rel="prefetch" href="/PenguinSeven/assets/js/99.cdf4931e.js"><link rel="prefetch" href="/PenguinSeven/assets/js/vendors~docsearch.70bf0358.js">
    <link rel="stylesheet" href="/PenguinSeven/assets/css/0.styles.feb1df48.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/PenguinSeven/" class="home-link router-link-active"><!----> <span class="site-name">吧食笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/PenguinSeven/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/PenguinSeven/php/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  PHP
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/PenguinSeven/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/PenguinSeven/php/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  PHP
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/PenguinSeven/php/" aria-current="page" class="active sidebar-link">PHP</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#函数解析" class="sidebar-link">函数解析</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#shell-exec" class="sidebar-link">shell_exec()</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#passthru" class="sidebar-link">passthru()</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#exec" class="sidebar-link">exec()</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#system" class="sidebar-link">system()</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#escapeshellcmd" class="sidebar-link">escapeshellcmd()</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#escapeshellarg" class="sidebar-link">escapeshellarg()</a></li></ul></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#开源项目" class="sidebar-link">开源项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#getid3" class="sidebar-link">getID3()</a></li></ul></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#常见问题" class="sidebar-link">常见问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#escapeshellarg-函数" class="sidebar-link">escapeshellarg 函数</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#php-cli-模式-判断文件是否存在错误" class="sidebar-link">php-cli 模式，判断文件是否存在错误</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#php并行-多进程-多线程" class="sidebar-link">PHP并行 多进程/多线程</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#composer-安装配置" class="sidebar-link">composer 安装配置</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#webbench-性能测试" class="sidebar-link">webBench 性能测试</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#xdebug-下载安装" class="sidebar-link">xdebug 下载安装</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#phpstorm-vagrant-xdebug-配置" class="sidebar-link">phpstorm + vagrant + xdebug 配置</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#api-设计理念" class="sidebar-link">API 设计理念</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#composer-http-提示" class="sidebar-link">composer http 提示：</a></li><li class="sidebar-sub-header"><a href="/PenguinSeven/php/#手动安装扩展" class="sidebar-link">手动安装扩展</a></li></ul></li></ul></li><li><a href="/PenguinSeven/php/laravel/" class="sidebar-link">laravel</a></li><li><a href="/PenguinSeven/php/yii/" class="sidebar-link">YII</a></li><li><a href="/PenguinSeven/php/swoole/" class="sidebar-link">swoole</a></li><li><a href="/PenguinSeven/php/workerman/" class="sidebar-link">Workerman</a></li><li><a href="/PenguinSeven/php/phpunit/" class="sidebar-link">Phpunit 单元测试</a></li><li><a href="/PenguinSeven/php/hash/register.html" class="sidebar-link">HASH</a></li><li><a href="/PenguinSeven/php/libevent.html" class="sidebar-link">Libevent扩展</a></li><li><a href="/PenguinSeven/php/functions.html" class="sidebar-link">常用函数</a></li><li><a href="/PenguinSeven/php/upcore.html" class="sidebar-link">upcore</a></li><li><a href="/PenguinSeven/php/error.html" class="sidebar-link">常见错误</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="php"><a href="#php" class="header-anchor">#</a> PHP</h1> <h2 id="函数解析"><a href="#函数解析" class="header-anchor">#</a> 函数解析</h2> <h3 id="shell-exec"><a href="#shell-exec" class="header-anchor">#</a> <strong>shell_exec()</strong></h3> <h3 id="passthru"><a href="#passthru" class="header-anchor">#</a> <strong>passthru()</strong></h3> <h3 id="exec"><a href="#exec" class="header-anchor">#</a> <strong>exec()</strong></h3> <h3 id="system"><a href="#system" class="header-anchor">#</a> <strong>system()</strong></h3> <h3 id="escapeshellcmd"><a href="#escapeshellcmd" class="header-anchor">#</a> <strong>escapeshellcmd()</strong></h3> <h3 id="escapeshellarg"><a href="#escapeshellarg" class="header-anchor">#</a> <strong>escapeshellarg()</strong></h3> <h2 id="开源项目"><a href="#开源项目" class="header-anchor">#</a> 开源项目</h2> <h3 id="getid3"><a href="#getid3" class="header-anchor">#</a> getID3()</h3> <p>getID3()这个PHP脚本能够从MP3或其它媒体文件<br>
(格式包括：Ogg，WMA，WMV，ASF，WAV，AVI，AAC，VQF，
FLAC，MusePack，Real，QuickTime，Monkey's Audio，MIDI等)
中提取有用的信息如：ID3标签,bitrate,播放时间等。</p> <h2 id="常见问题"><a href="#常见问题" class="header-anchor">#</a> 常见问题</h2> <h3 id="escapeshellarg-函数"><a href="#escapeshellarg-函数" class="header-anchor">#</a> escapeshellarg 函数</h3> <p>(PHP 4 &gt;= 4.0.3, PHP 5, PHP 7)</p> <p>escapeshellarg — 把字符串转码为可以在 shell 命令里使用的参数</p> <p>When escapeshellarg() was stripping my non-ASCII characters from a UTF-8 string, adding the following fixed the problem:</p> <p>ex:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls '</span><span class="token operator">.</span><span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>fixed :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">setlocale</span><span class="token punctuation">(</span><span class="token constant">LC_CTYPE</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;en_US.UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls '</span><span class="token operator">.</span><span class="token function">escapeshellarg</span><span class="token punctuation">(</span><span class="token variable">$dir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="php-cli-模式-判断文件是否存在错误"><a href="#php-cli-模式-判断文件是否存在错误" class="header-anchor">#</a> php-cli 模式，判断文件是否存在错误</h3> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">clearstatcache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>clearstatcache() 函数会缓存某些函数的返回信息，
以便提供更高的性能。但是有时候，比如在一个脚本中多次检查同一个文件，
而该文件在此脚本执行期间有被删除或修改的危险时，你需要清除文件状态缓存，
以便获得正确的结果。要做到这一点，就需要使用 clearstatcache() 函数。
会进行缓存的函数，即受 clearstatcache() 函数影响的函数：</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">stat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">lstat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_writable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_readable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_executable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">is_link</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">filectime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fileatime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">filemtime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fileinode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">filegroup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fileowner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">filetype</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fileperms</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre></div><p>example :</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token comment">//检查文件大小</span>
    <span class="token keyword">echo</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;test.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;test.txt&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;a+&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 截取文件</span>
    <span class="token function">ftruncate</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">//清除缓存并再次检查文件大小</span>
    <span class="token function">clearstatcache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token function">filesize</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;test.txt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><h3 id="php并行-多进程-多线程"><a href="#php并行-多进程-多线程" class="header-anchor">#</a> PHP并行 多进程/多线程</h3> <p>PHP中提供了一个扩展pcntl，可以利用操作系统的fork调用来实现多进程。
fork调用后执行的代码将是并行的。</p> <p>注：pcntl仅支持linux平台，并且只能在cli模式下使用。</p> <div class="language-php extra-class"><pre class="language-php"><code>    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
        <span class="token variable">$pid</span> <span class="token operator">=</span> <span class="token function">pcntl_fork</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$pid</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            
                <span class="token comment">//父进程代码</span>
                
                <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token punctuation">}</span> <span class="token keyword">elseif</span><span class="token punctuation">(</span><span class="token variable">$pid</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            
                <span class="token comment">//子进程代码</span>
                
                <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token punctuation">}</span>
    <span class="token delimiter important">?&gt;</span></span>
</code></pre></div><ol start="0"><li><p>此扩展仅在线程安全版本中可用,多线程扩展<a href="http://pecl.php.net/package/pthreads" target="_blank" rel="noopener noreferrer">http://pecl.php.net/package/pthreads<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>多进程和多线程其实是作用是相同的。区别是</p> <ul><li>线程是在同一个进程内的，可以共享内存变量实现线程间通信</li> <li>线程比进程更轻量级，开很大量进程会比线程消耗更多系统资源</li> <li>多线程也存在一些问题：</li></ul></li> <li><p>线程读写变量存在同步问题，需要加锁</p> <ul><li>锁的粒度过大会有性能问题，可能会导致只有1个线程在运行，其他线程都在等待锁。这样就不是并行了</li> <li>同时使用多个锁，逻辑复杂，一旦某个锁没被正确释放，可能会发生线程死锁</li> <li>某个线程发生致命错误会导致整个进程崩溃</li></ul></li> <li><p>多进程方式更加稳定，另外利用进程间通信（IPC）也可以实现数据共享。</p> <ul><li>共享内存，这种方式和线程间读写变量是一样的，需要加锁，会有同步、死锁问题。</li> <li>消息队列，可以采用多个子进程抢队列模式，性能很好</li> <li>PIPE，UnixSock，TCP，UDP。可以使用read/write来传递数据，TCP/UDP方式使用socket来通信，子进程可以分布运行</li></ul></li></ol> <h3 id="composer-安装配置"><a href="#composer-安装配置" class="header-anchor">#</a> composer 安装配置</h3> <ul><li>第一种</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 下载</span>
$ <span class="token function">curl</span> <span class="token parameter variable">-sS</span> https://getcomposer.org/installer <span class="token operator">|</span> php
<span class="token comment"># 放入全局</span>
$ <span class="token function">mv</span> composer.phar /usr/local/bin/composer
<span class="token comment"># 修改源</span>
$ <span class="token function">composer</span> config <span class="token parameter variable">-g</span> repo.packagist <span class="token function">composer</span> https://packagist.phpcomposer.com
<span class="token comment"># 设置自动更新</span>
$ <span class="token function">composer</span> selfupdate
</code></pre></div><ul><li>第二种</li></ul> <div class="language-shell script extra-class"><pre class="language-shell"><code>php <span class="token parameter variable">-r</span> <span class="token string">&quot;copy('https://getcomposer.org/installer', 'composer-setup.php');&quot;</span>
php <span class="token parameter variable">-r</span> <span class="token string">&quot;if (hash_file('sha384', 'composer-setup.php') === 'a5c698ffe4b8e849a443b120cd5ba38043260d5c4023dbf93e1558871f1f07f58274fc6f4c93bcfd858c6bd0775cd8d1') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;&quot;</span>
php composer-setup.php
php <span class="token parameter variable">-r</span> <span class="token string">&quot;unlink('composer-setup.php');&quot;</span>
</code></pre></div><div class="language-shell script extra-class"><pre class="language-shell"><code><span class="token function">mv</span> composer.phar /usr/local/bin/composer
<span class="token function">sudo</span> <span class="token function">chmod</span> +x /usr/local/bin/composer
</code></pre></div><div class="language-shell script extra-class"><pre class="language-shell"><code><span class="token function">composer</span> config <span class="token parameter variable">-g</span> repo.packagist <span class="token function">composer</span> https://mirrors.aliyun.com/composer/
</code></pre></div><h4 id="phpunit-单元测试"><a href="#phpunit-单元测试" class="header-anchor">#</a> phpunit 单元测试</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">composer</span> global require phpunit/phpunit
</code></pre></div><p>全局安装PHPUnit。<br>
然后在<code>~/.bashrc</code>文件末尾加一行<code>PATH=$PATH:/home/feng/.composer/vendor/bin</code>  （注意替换用户名），来将<code>Composer</code>的<code>global bin</code>目录加入<code>PATH</code>。</p> <h3 id="webbench-性能测试"><a href="#webbench-性能测试" class="header-anchor">#</a> webBench 性能测试</h3> <ul><li>安装</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">wget</span> http://home.tiscali.cz/~cz210552/distfiles/webbench-1.5.tar.gz
$ <span class="token function">tar</span> zxvf webbench-1.5.tar.gz
$ <span class="token builtin class-name">cd</span> webbench-1.5
$ <span class="token function">make</span>
$ <span class="token function">make</span> <span class="token function">install</span>
</code></pre></div><ul><li>使用：</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># webbench -c 并发数 -t 运行测试时间 URL</span>
$ webbench <span class="token parameter variable">-c</span> <span class="token number">1000</span> <span class="token parameter variable">-t</span> <span class="token number">60</span> http://192.168.80.157/phpinfo.php
</code></pre></div><h3 id="xdebug-下载安装"><a href="#xdebug-下载安装" class="header-anchor">#</a> xdebug 下载安装</h3> <p><a href="https://xdebug.org/download.php" target="_blank" rel="noopener noreferrer">下载<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ( 注意NTS | TS)</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">tar</span> <span class="token parameter variable">-zxvf</span> xx.tgz
$ <span class="token builtin class-name">cd</span> xx
$ phpize
$ ./configure
$ <span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
</code></pre></div><p>修改配置文件：</p> <div class="language-ini extra-class"><pre class="language-ini"><code><span class="token section"><span class="token punctuation">[</span><span class="token section-name selector">xdebug</span><span class="token punctuation">]</span></span>
<span class="token key attr-name">zend_extension</span><span class="token punctuation">=</span><span class="token value attr-value">xdebug.so</span>
<span class="token key attr-name">xdebug.remote_enable</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">xdebug.remote_connect_back</span> <span class="token punctuation">=</span> <span class="token value attr-value">1</span>
<span class="token key attr-name">xdebug.remote_port</span> <span class="token punctuation">=</span> <span class="token value attr-value">9000</span>
<span class="token key attr-name">xdebug.max_nesting_level</span> <span class="token punctuation">=</span> <span class="token value attr-value">512</span>
</code></pre></div><h3 id="phpstorm-vagrant-xdebug-配置"><a href="#phpstorm-vagrant-xdebug-配置" class="header-anchor">#</a> phpstorm + vagrant + xdebug 配置</h3> <ul><li><p>php  》 severs 》 目录映射</p></li> <li><p>run/debug configuration 》 PHP WEB Application 》</p></li> <li><p>重启php-fpm，必须重启</p></li></ul> <h3 id="api-设计理念"><a href="#api-设计理念" class="header-anchor">#</a> API 设计理念</h3> <p>将涉及的实体抽象成资源，即按 id 访问资源，在 url 上做文章，以后再也不用为 url 起名字而苦恼了；<br>
使用 HTTP 动词对资源进行 CRUD（增删改查）：get -&gt; 查, post -&gt; 增, put -&gt; 改, delete -&gt; 删<br>
URL 命名规则，对于资源无法使用一个单数名词表示的情况，我使用中横线 - 连接</p> <ul><li>资源采用名词命名，e.g：产品 -&gt; product</li> <li>新增资源，e.g：新增产品 url -&gt; /product, verb -&gt; POST</li> <li>修改资源，e.g：修改产品 url -&gt; /products/{id}, verb -&gt; PUT</li> <li>资源详情，e.g：指定产品详情 url -&gt; /products/{id}, verb -&gt; GET</li> <li>删除资源，e.g：删除产品 url -&gt; /products/{id}, verb -&gt; DELETE</li> <li>资源列表，e.g：产品列表 url -&gt; /products, verb -&gt; GET</li> <li>资源关联关系，e.g：收藏产品 url -&gt; /products/{id}/star, verb -&gt; PUT</li> <li>资源关联关系，e.g：删除收藏产品 url -&gt; /products/{id}/star, verb -&gt; DELETE</li></ul> <h3 id="composer-http-提示"><a href="#composer-http-提示" class="header-anchor">#</a> composer http 提示：</h3> <div class="language-textmate extra-class"><pre class="language-text"><code> Your configuration does not allow connection to http://packagist.phpcomposer.com. See https://getcomposer.org/doc/06-config.md#secure-http for details  
</code></pre></div><p>网上查一下，说是因为镜像使用用的是http，而原地址是需要https，所以配置下关掉https就好了。</p> <ul><li>修改composer.json文件</li></ul> <p>view plain copy</p> <div class="language-json extra-class"><pre class="language-json"><code>        <span class="token punctuation">{</span>  
            <span class="token property">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>  
                <span class="token property">&quot;secure-http&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>  
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>  
</code></pre></div><ul><li>参数</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">composer</span> config <span class="token parameter variable">-g</span> secure-http <span class="token boolean">false</span>
</code></pre></div><h3 id="手动安装扩展"><a href="#手动安装扩展" class="header-anchor">#</a> 手动安装扩展</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /root/oneinstack/src
<span class="token function">tar</span> zxvf php-7.4.5.tar.gz  <span class="token comment"># 解压已经安装的php版本</span>
<span class="token builtin class-name">cd</span> php-7.4.5/ext/fileinfo
/usr/local/php/bin/phpize
./configure --with-php-config<span class="token operator">=</span>/usr/local/php/bin/php-config
<span class="token function">make</span> <span class="token operator">&amp;&amp;</span> <span class="token function">make</span> <span class="token function">install</span>
<span class="token builtin class-name">cd</span> /usr/local/php/lib/php/extensions
<span class="token function">ls</span>  <span class="token comment">#看到no-debug-non-zts-20131226类似文件夹</span>
<span class="token builtin class-name">cd</span> no-debug-non-zts-20131226
<span class="token function">ls</span>  <span class="token comment">#查看有没有 fileinfo.so,如果有，证明编译成功</span>
加载fileinfo
<span class="token builtin class-name">echo</span> <span class="token string">'extension=fileinfo.so'</span> <span class="token operator">&gt;</span> /usr/local/php/etc/php.d/ext-fileinfo.ini
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新时间:</span> <span class="time">8/27/2021, 3:20:10 AM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/PenguinSeven/php/laravel/">
        laravel
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/PenguinSeven/assets/js/app.e3215620.js" defer></script><script src="/PenguinSeven/assets/js/2.f28e70e0.js" defer></script><script src="/PenguinSeven/assets/js/1.bb87e0ea.js" defer></script><script src="/PenguinSeven/assets/js/75.f13216e5.js" defer></script>
  </body>
</html>
