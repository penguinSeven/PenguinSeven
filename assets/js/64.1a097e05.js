(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{399:function(a,t,s){"use strict";s.r(t);var r=s(25),e=Object(r.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"vagrant"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vagrant"}},[a._v("#")]),a._v(" vagrant")]),a._v(" "),t("h2",{attrs:{id:"_1-安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装"}},[a._v("#")]),a._v(" 1. 安装")]),a._v(" "),t("h3",{attrs:{id:"下载virtualbox"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载virtualbox"}},[a._v("#")]),a._v(" 下载VirtualBox")]),a._v(" "),t("p",[a._v("https://www.virtualbox.org/wiki/Download_Old_Builds")]),a._v(" "),t("h3",{attrs:{id:"下载vagrant"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载vagrant"}},[a._v("#")]),a._v(" 下载vagrant")]),a._v(" "),t("p",[a._v("https://releases.hashicorp.com/vagrant/")]),a._v(" "),t("h3",{attrs:{id:"下载-ubuntu"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载-ubuntu"}},[a._v("#")]),a._v(" 下载 Ubuntu")]),a._v(" "),t("p",[a._v("链接一：http://pan.baidu.com/s/1i5BfL45 密码：himr")]),a._v(" "),t("h3",{attrs:{id:"其他版本box"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他版本box"}},[a._v("#")]),a._v(" 其他版本box")]),a._v(" "),t("p",[a._v("http://www.vagrantbox.es/")]),a._v(" "),t("p",[t("em",[a._v("本文使用 vagrant 1.9.2 + VirtualBox 5.1 + ubunt 14.04")])]),a._v(" "),t("h2",{attrs:{id:"_2-使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用"}},[a._v("#")]),a._v(" 2. 使用")]),a._v(" "),t("h3",{attrs:{id:"测试vagrant是否安装成功"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#测试vagrant是否安装成功"}},[a._v("#")]),a._v(" 测试vagrant是否安装成功")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ vagrant "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v("\n")])])]),t("h3",{attrs:{id:"查看列表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看列表"}},[a._v("#")]),a._v(" 查看列表")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ vagrant box list\n")])])]),t("h3",{attrs:{id:"添加列表"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加列表"}},[a._v("#")]),a._v(" 添加列表")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ vagrant box "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),a._v(" ubuntu1404 ubuntu1404.box\n")])])]),t("h3",{attrs:{id:"初始化虚拟机"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#初始化虚拟机"}},[a._v("#")]),a._v(" 初始化虚拟机")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" ubuntu\n$ "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" ubuntu\n$ vagrant box init ubuntu1404\n")])])]),t("h3",{attrs:{id:"操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#操作"}},[a._v("#")]),a._v(" 操作")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ vagrant up // 开机\n$ vagrant "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("halt")]),a._v(" // 关机\n$ vagrant status // 状态\n$ vagrant "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v("  // "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" 登录\n")])])]),t("p",[a._v("###优化")]),a._v(" "),t("ul",[t("li",[a._v("虚拟机名称")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v(" vb.name "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ubuntu_mooc"')]),a._v("\n")])])]),t("ul",[t("li",[a._v("虚拟机主机名")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("config.vm.hostname "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mooc"')]),a._v("\n")])])]),t("ul",[t("li",[a._v("配置虚拟机内存和CPU")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vb.memory "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1024"')]),a._v("\nvb.cpus "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n")])])]),t("ul",[t("li",[a._v("配置IP")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("config.vm.network "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"public_network"')]),a._v(", ip: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.1.122"')]),a._v(", auto_config: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("ul",[t("li",[a._v("配置共享目录")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("config.vm.synced_folder "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/Users/vincent/code/"')]),a._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/home/www"')]),a._v(", :nfs "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("h3",{attrs:{id:"打包命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打包命令"}},[a._v("#")]),a._v(" 打包命令")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("vagrant package "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--output")]),a._v(" xxx.box    \n")])])]),t("h3",{attrs:{id:"注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[a._v("#")]),a._v(" 注意事项")]),a._v(" "),t("ul",[t("li",[a._v("vagrant ssh 无法登录  （使用git bash 命令行模式，进入对应文件夹，vagrant ssh 登录）")])]),a._v(" "),t("p",[a._v("###　参考文献")]),a._v(" "),t("ul",[t("li",[a._v("git (https://github.com/apanly/mooc/tree/master/vagrant)")])]),a._v(" "),t("h2",{attrs:{id:"常见问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[a._v("#")]),a._v(" 常见问题")]),a._v(" "),t("h3",{attrs:{id:"_1-mount-unknown-filesystem-type-vboxsf"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-mount-unknown-filesystem-type-vboxsf"}},[a._v("#")]),a._v(" 1. mount: unknown filesystem type 'vboxsf'")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" virtualbox-guest-utils\n")])])]),t("p",[a._v("vagrant reload后问题完美解决。")]),a._v(" "),t("h3",{attrs:{id:"_2-virtualbox-mount-vboxsf-mounting-failed-with-the-error-no-such-device"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-virtualbox-mount-vboxsf-mounting-failed-with-the-error-no-such-device"}},[a._v("#")]),a._v(" 2. VirtualBox: mount.vboxsf: mounting failed with the error: No such device")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# apt-get install linux-headers-$(uname -r)")]),a._v("\n    \nvagrant reload\n")])])]),t("h3",{attrs:{id:"_3-打包后启动失败"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-打包后启动失败"}},[a._v("#")]),a._v(" 3. 打包后启动失败")]),a._v(" "),t("ul",[t("li",[a._v("打包时注释私有网络设置")])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v('# config.vm.network "public_network", ip: "192.168.1.125"')]),a._v("\n")])])]),t("ul",[t("li",[a._v("在新的box下，修改私有网络的配置,添加 "),t("strong",[a._v("auto_config: true")])])]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("config.vm.network "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"public_network"')]),a._v(", ip: "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"192.168.1.125"')]),a._v(", auto_config: "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n")])])]),t("h2",{attrs:{id:"制作自己的vagrant-box"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#制作自己的vagrant-box"}},[a._v("#")]),a._v(" 制作自己的Vagrant Box")]),a._v(" "),t("h3",{attrs:{id:"摘自-https-segmentfault-com-a-1190000002507999"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#摘自-https-segmentfault-com-a-1190000002507999"}},[a._v("#")]),a._v(" 摘自(https://segmentfault.com/a/1190000002507999)")]),a._v(" "),t("h3",{attrs:{id:"前置条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#前置条件"}},[a._v("#")]),a._v(" 前置条件")]),a._v(" "),t("ul",[t("li",[a._v("安装VirtualBox")]),a._v(" "),t("li",[a._v("安装Vagrant")]),a._v(" "),t("li",[a._v("在VirtualBox中安装操作系统，例如 CentOS")])]),a._v(" "),t("h3",{attrs:{id:"想要将操作系统打包为可用的vbox镜像要做以下工作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#想要将操作系统打包为可用的vbox镜像要做以下工作"}},[a._v("#")]),a._v(" 想要将操作系统打包为可用的Vbox镜像要做以下工作")]),a._v(" "),t("ul",[t("li",[a._v("创建vagrant用户和用户目录，密码为vagrant")]),a._v(" "),t("li",[a._v("添加vagrant用户的公共密钥，文件为/home/vagrant/.ssh/authorized_keys")]),a._v(" "),t("li",[a._v("在真实操作系统中执行vagrant package --base 虚拟机名称，这样会创建指定虚拟机的box")]),a._v(" "),t("li",[a._v("将制作好的Box添加到Vagrant环境中，vagrant box add name package.box")]),a._v(" "),t("li",[a._v("初始化运行环境,vagrant init name")]),a._v(" "),t("li",[a._v("运行Vagrant虚拟机，vagrant up\n到此完成整个流程")])]),a._v(" "),t("h3",{attrs:{id:"authorized-keys-文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#authorized-keys-文件"}},[a._v("#")]),a._v(" authorized_keys 文件")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDbJuFDiLjyQM+p0cf2Edc46ibW3C2TYLU41DrFvxfeU2zWR3aE7NkPG9edIn94fWGKLfEUFfiiqN5+VDuJfMSKEyxVoXOGdFWBKkrR6oOXM0LfzPZCEiSswMj01RqCaY148nZOg7zvmNkAD/yX4o6jfsoZSGXE8rxRPwogFHhsDp0vqsibw4KW3b3ZhlVUQzHr0+eOqAsGiwqkDTgOfJGgrZykzYzho81HLQ48d1Doh6LQF90TZcVElpY7jtiMvaQKb2wrXlhZsrZZYJg5F/wi2ulc2ZmdrwP7lXn8MMwByR6f1xUvXRdmrU6pQPXIXYfLkZuSjYj485OxJhdXzus3 vagrant\n")])])]),t("h3",{attrs:{id:"问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[a._v("#")]),a._v(" 问题")]),a._v(" "),t("h4",{attrs:{id:"_1-ssh登录不了"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-ssh登录不了"}},[a._v("#")]),a._v(" 1. ssh登录不了")]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("$ vagrant "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v("\nssh_exchange_identification: read: Software caused connection abort\n")])])])])}),[],!1,null,null,null);t.default=e.exports}}]);