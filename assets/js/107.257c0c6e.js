(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{447:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"inno-setup-学习心得"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#inno-setup-学习心得"}},[t._v("#")]),t._v(" INNO SETUP 学习心得")]),t._v(" "),s("blockquote",[s("p",[t._v("###1.脚本结构")])]),t._v(" "),s("hr"),t._v(" "),s("ol",[s("li",[t._v("[Setup] 段\n　　\n　　这个段包括了安装和卸载程序所使用的全局设置，并且有些关键字在你建立的安装程序中是必须要用到的。")]),t._v(" "),s("li",[t._v("[Dirs] 段\n　　\n　　这个段是可选的，而且通常对于大多数简单的应用程序来书不是必需的。这个段是用来创建除用户选择的应用程序目录以外的其它的附加的目录，它是被自动创建的。这个段所创建的子目录是可以脱离主应用程序而共同使用的目录。当然在 [Files] 段里面的文件被复制到某个目录之前你并不一定要创建它，然而在卸载程序的时候在 [Dirs] 和 [UninstallDelete] 段里面没有指定的目录就不会被删除。")]),t._v(" "),s("li",[t._v("[Files] 段\n　　\n　　这个段是可选的，但对于大多数安装程序来说是必不可少的。在这里定义了安装程序需要复制到用户的系统当中的全部文件。\n　　\n　　在安装期间，卸载程序和数据被自动的复制到应用程序的目录当中去，因此你不必手工的将它们添加到 [Files] 段。")]),t._v(" "),s("li",[t._v("[Icons] 段\n　　\n　　这个段是可选的，但对于大多数安装程序来说是必不可少的。它定义了所有的安装程序要在用户系统中创建的程序管理器/开始菜单的图标。它也能被用来在其它的位置创建应用程序图标（快捷方式），比如就像桌面。\n　　\n　　卸载图标是由安装程序内部创建的，这样一来你就不需要在 [Icons] 段里面手工的添加它。默认情况下，安装程序运行在 Windows 95/NT 4+ 的时候是不创建卸载图标的 ――除了安装程序运行于 Windows NT 3.51 的时候。 要强制创建一个卸载图标，请使用 [Setup] 段里面的 AlwaysCreateUninstallIcon 关键字。")]),t._v(" "),s("li",[t._v("[INI] 段\n　　\n　　此段是可选的，它定义了一些 .INI 文件项，在文件被复制以后安装程序在用户的系统中的设定。")]),t._v(" "),s("li",[t._v("[InstallDelete] 段\n　　\n　　它使用的是和 [UninstallDelete] 段相同的格式，不同的是它是在安装程序的第一步被处理的。")]),t._v(" "),s("li",[t._v("[Messages] 段\n　　\n　　[Messages] 段是用于定义安装程序和卸载程序所显示的消息。通常你不需要在你的脚本文件里面创建 [Messages] 段，默认情况下所有的显示消息都由 Inno Setup 包含的文件 Default.isl 定义。 （或由 [Setup] 段的关键字 MessagesFile 指定的任何文件）。")]),t._v(" "),s("li",[t._v("[Registry] 段\n　　\n　　这个段是可选的，他定义了一些注册表项，用于在复制完文件之后创建在用户的系统中。")]),t._v(" "),s("li",[t._v("[Run] %26amp; [UninstallRun] 段\n　　\n　　[Run] 段是可选的，指定任意数量的程序在成功安装程序以后及显示结束对话框之前被执行。同样 [UninstallRun] 段也是可选的，指定任意数量的程序在%26ldquo;卸载程序%26rdquo;的第一步时被执行。除非下面有其它说明，两个段共有相同的语法。\n　　每个程序按照你的脚本编排的顺序被执行，当出路 [Run]/[UninstallRun] 的项时，安装程序将会等到当前的程序终止之后才处理下一个，当然除非使用了 nowait 标记。")]),t._v(" "),s("li",[t._v("[UninstallDelete] 段\n　　\n　　该段是可选的。该段是用来定义一些附加的除了那些被安装的应用程序之外的要被卸载程序删除的文件或目录。使用该段来删除由你的应用程序创建的 .INI 文件是一个常用的办法。卸载程序在卸载过程的最后一步处理这些项。")])]),t._v(" "),s("p"),t._v(" "),s("blockquote",[s("p",[t._v("###2.目录常量")])]),t._v(" "),s("hr"),t._v(" "),s("p",[t._v("{app}\n　　应用程序目录，这是用户在安装向导的选择安装目录页里面所选择的。\n　　例如：如果你使用了 {app}\\MYPROG.EXE 作为一项并且用户选择了“C:\\MYPROG”作为应用程序的目录，那么安装程序就会将它转换成“C:\\MYPROG\\MYPROG.EXE”。")]),t._v(" "),s("p",[t._v("{win}\n　　系统的 Windows 目录。例如：如果你使用了 {win}\\MYPROG.INI 作为一项并且系统的 Windows 目录是“C:\\WINDOWS”，那么安装程序就会将它转换成“C:\\WINDOWS\\MYPROG.INI”。")]),t._v(" "),s("p",[t._v("{sys}\n　　系统的 Windows 系统(System)目录(在 Windows NT/2000 下是 System32)。例如：如果你使用了 {sys}\\ CTL3D32.DLL 作为一项并且系统的 Windows 系统目录是“C:\\WINDOWS\\SYSTEM”，那么安装程序就会将它转换成“C:\\ WINDOWS\\SYSTEM\\CTL3D32.DLL”。")]),t._v(" "),s("p",[t._v("{src}\n　　这个文件夹指向安装程序所在的位置。\n　　例如：如果你使用了 {src}\\MYPROG.EXE 作为一项并且用户是从“S:\\ ”安装的，那么安装程序就会将它转换成“S:\\MYPROG.EXE”。")]),t._v(" "),s("p",[t._v("{sd}\n　　系统驱动器，它是指 Windows 被安装到的那个驱动器，典型的是“C:”，对于 Windows NT/2000，这个常量同系统的环境变量“SystemDrive”是等效的。")]),t._v(" "),s("p",[t._v("{pf}\n　　程序文件夹(Program Files)，这个路径是系统的 Program Files 目录，典型的是“C:\\Program Files”。")]),t._v(" "),s("p",[t._v("{cf}\n　　公共文件夹(Common Files)，这个路径是系统的 Common Files 文件夹，典型的是“C:\\Program Files\\Common Files”。")]),t._v(" "),s("p",[t._v("{tmp}\n　　临时目录，这个目录并不是用户的 TEMP 环境变量指向的目录，而是安装程序在启动时在用户的临时目录下建立的一个子目录，在安装程序退出时所有的文件和子目录将会被删除。对于在 [Run] 段里面要被执行且在安装以后又不需要的程序文件来说这个功能是非常有用的。")]),t._v(" "),s("p",[t._v("{fonts}\n　　字体目录，在 Windows 95/NT 4+ 下有一个专门为字体设立的目录(通常这个目录在 Windows 目录下且被命名为“FONTS”)，这个常量就指向这个目录。对于 Windows NT 3.51，这个常量是和 {sys} 等效的，因为当时还没有字体目录。")]),t._v(" "),s("p",[t._v("{dao}\nDAO 目录，当安装程序运行在 Windows 95/NT 4+ 上时，它被等效为 {cf}\\Microsoft Shared\\DAO，当运行于 Windows NT 3.51 时，它被等效为 {win}\\MSAPPS\\DAO。")]),t._v(" "),s("blockquote",[s("p",[t._v("###3.常见问题")])]),t._v(" "),s("hr"),t._v(" "),s("h2",{attrs:{id:"多语言安装包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多语言安装包"}},[t._v("#")]),t._v(" 多语言安装包")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Languages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "en"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" MessagesFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "compiler'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Default")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('isl" '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" LicenSeFile "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('"E'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\upupw\\doc\\readme_en"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('txt"\n'),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "chs"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" MessagesFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "compiler'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("Languages\\china"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('isl"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" LicenSeFile "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v('"E'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\upupw\\doc\\readme_chs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('txt"\n\n'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Messages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BeveledLabel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("English\nchs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("BeveledLabel"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Chineses\n\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("CustomMessages"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MyAppName          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Intelligent paperless conference management server\nen"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Uninstall          "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Uninstall\n\n\nchs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MyAppName         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 智能无纸化会议管理服务器\nchs"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Uninstall         "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" 卸载\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" 调用\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{cm:MyAppName}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"修改ini文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改ini文件"}},[t._v("#")]),t._v(" 修改ini文件")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("用于在用户系统中创建，修改或删除ini文件健值\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nFilename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v("\\cfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('ini"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Section"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "Startup Options"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" uninsdeletesection\nFilename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v("\\cfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('ini"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Section"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "Startup Options"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "server ip"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),t._v('"\nFilename'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v("\\cfg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('ini"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Section"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "Startup Options"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "server port"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v('"\n\n')])])]),s("h2",{attrs:{id:"安装、卸载判断进程-窗口名称"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装、卸载判断进程-窗口名称"}},[t._v("#")]),t._v(" 安装、卸载判断进程(窗口名称)")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断进程")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\nErrorCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nIsRunning"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装时判断客户端是否正在运行  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeSetup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装程序继续  ")]),t._v("\nIsRunning"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v("FindWindowByWindowName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'东方宽频网络电视'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" IsRunning"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" Msgbox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'安装程序检测到客户端正在运行。'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("#13#13")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'您必须先关闭它然后单击“是”继续安装，或按“否”退出！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbConfirmation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_YESNO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" idNO "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装程序退出  ")]),t._v("\n      IsRunning "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装程序继续  ")]),t._v("\n      IsRunning"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v("FindWindowByWindowName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'东方宽频网络电视'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 卸载时判断客户端是否正在运行  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeUninstall"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装程序继续  ")]),t._v("\nIsRunning"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v("FindWindowByWindowName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'东方宽频网络电视'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" IsRunning"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" Msgbox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'安装程序检测到客户端正在运行。'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("#13#13")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'您必须先关闭它然后单击“是”继续安装，或按“否”退出！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbConfirmation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_YESNO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" idNO "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装程序退出  ")]),t._v("\n      IsRunning "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装程序继续  ")]),t._v("\n      IsRunning"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v("FindWindowByWindowName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'东方宽频网络电视'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"安装、卸载判断进程-进程名称"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装、卸载判断进程-进程名称"}},[t._v("#")]),t._v(" 安装、卸载判断进程(进程名称)")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//引入库文件，不操作文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "E'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\\upupw\\psvince"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('dll"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" dontcopy\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//code 段引用文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" IsModuleLoaded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("modulename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" AnsiString "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("  Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IsModuleLoaded@files:psvince.dll stdcall'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// PSVince控件在64位系统（Windows 7/Server 2008/Server 2012）下无法检测到进程，使用下面的函数可以解决。")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" IsAppRunning"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" FileName "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n    FSWbemLocator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    FWMIService   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    FWbemObjectSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n      FSWbemLocator "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" CreateOleObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'WBEMScripting.SWBEMLocator'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      FWMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" FSWbemLocator"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ConnectServer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'root\\CIMV2'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      FWbemObjectSet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" FWMIService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ExecQuery"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Format"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SELECT Name FROM Win32_Process Where Name=\"%s\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("FileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FWbemObjectSet"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Count "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      FWbemObjectSet "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Unassigned"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      FWMIService "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Unassigned"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      FSWbemLocator "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Unassigned"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IsModuleLoaded"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("FileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// example 判断进程是否正在运行")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeSetup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v("  IsAppRunning"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'httpd.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'安装程序检测到 {#MyAppName} 正在运行！'#13''#13'单击“是”按钮关闭程序并继续安装；'#13''#13'单击“否”按钮退出安装！'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbConfirmation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_YESNO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" IDYES "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n")])])]),s("h2",{attrs:{id:"界面显示控制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#界面显示控制"}},[t._v("#")]),t._v(" 界面显示控制")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 界面显示控制，true 为隐藏")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//预定义向导页 CurPageID 值")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//wpWelcome, wpLicense, wpPassword, wpInfoBefore, wpUserInfo, wpSelectDir, wpSelectComponents, wpSelectProgramGroup, wpSelectTasks, wpReady, wpPreparing, wpInstalling, wpInfoAfter, wpFinished")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" ShouldSkipPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PageID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PageID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wpSelectDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RadioButton1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Checked"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PageID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wpSelectProgramGroup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RadioButton1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Checked"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[t._v("#")]),t._v(" 环境变量")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//添加环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CurStepChanged"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TSetupStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurStep "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ssPostInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n   SetEnv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}/Package/bpl;{app}/bin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在这儿调用,一定在这儿调用,安装完无须重启,立即生效")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//SetEnv('path','{app}/bin',true,true);")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//删除环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CurUninstallStepChanged"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurUninstallStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TUninstallStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\nSetEnv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}/Package/bpl;{app}/bin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//SetEnv('path','{app}/bin',false,true);")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"自定义单选界面-含单击事件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义单选界面-含单击事件"}},[t._v("#")]),t._v(" 自定义单选界面（含单击事件）")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// 自定义界面\n var\n  Page: TWizardPage; \n  RadioButton1, RadioButton2: TRadioButton;\n  Lbl1, Lbl2: TNewStaticText;\n  TaskCode: Boolean;  \n\n\n{radio1的事件响应过程}\nprocedure ClickRadio1(Sender: TObject);\nbegin\n       TaskCode := true;\nend;\n\n{radio2的事件响应过程}\nprocedure ClickRadio2(Sender: TObject);\nbegin\n       TaskCode := false;\nend;\n \nprocedure CreateAddonPage;\nbegin\n  Page := CreateCustomPage(wpInfoBefore, '选择安装类型', '请根据您的需要选择安装的类型'); \n      \n  RadioButton1 := TRadioButton.Create(Page);\n  RadioButton1.Left := ScaleX(45);\n  RadioButton1.Top := ScaleY(40);\n  RadioButton1.Width := Page.SurfaceWidth;\n  RadioButton1.Height := ScaleY(17);\n  RadioButton1.Caption := '标准安装';\n  RadioButton1.Checked := True;\n  RadioButton1.Parent := Page.Surface;\n  RadioButton1.OnClick:=@ClickRadio1;\n \n  Lbl1 := TNewStaticText.Create(Page);\n  Lbl1.Left := ScaleX(55);\n  Lbl1.Top := ScaleY(60);\n  Lbl1.Width := ScaleX(250);\n  Lbl1.Height := ScaleY(50);\n  Lbl1.Caption := '按照标准模式安装软件到您的电脑，数据库将更新覆盖。';\n  Lbl1.Parent := Page.Surface;\n \n  RadioButton2 := TRadioButton.Create(Page);\n  RadioButton2.Left := ScaleX(45);\n  RadioButton2.Top := RadioButton1.Top + ScaleY(60);\n  RadioButton2.Width := Page.SurfaceWidth;\n  RadioButton2.Height := ScaleY(17);\n  RadioButton2.Caption := '更新';\n  RadioButton2.Checked := false;\n  RadioButton2.Parent := Page.Surface;\n  RadioButton2.OnClick:=@ClickRadio2;\n \n  Lbl2 := TNewStaticText.Create(Page);\n  Lbl2.Left := ScaleX(55);\n  Lbl2.Top := Lbl1.Top + ScaleY(60);\n  Lbl2.Width := ScaleX(250);\n  Lbl2.Height := ScaleY(50);\n  Lbl2.Caption := '数据库不覆盖。';\n  Lbl2.Parent := Page.Surface;\nend;\n\n// 事件函数 初始化 \nprocedure InitializeWizard();\nbegin\n  CreateAddonPage;\nend;\n\n")])])]),s("h2",{attrs:{id:"插件函数-替换卸载图标"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插件函数-替换卸载图标"}},[t._v("#")]),t._v(" 插件函数 (替换卸载图标)")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//插件函数用法  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//参数: 句柄(插件错误对话框的父句柄), exe文件完整路径名称, (exe文件中要替换的)图标资源名称, 图标文件的完整路径名称, (exe中要替换的图标资源所在)语系  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//返回值: 成功 = True, 失败 = False  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//安装初始化  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" UpdateIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hWnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" exeFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exeIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IcoFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" wlangID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DWORD"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("external")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UpdateIcon@files:UpdateIcon.dll stdcall'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//替换卸载程序的图标  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" UpdateUninstIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" IcoFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("   \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//要替换图标的exe文件路径名称留空，则插件会自动替换掉Inno卸载程序的图标！其它参数类似！  ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" UpdateIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MainForm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Handle"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" IcoFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//替换卸载图标  ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CurStepChanged"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TSetupStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" uninspath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uninsname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" NewUninsName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MyAppName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注意: 替换卸载程序的图标，必须是在卸载程序生成之前！  ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//建议安装图标与卸载图标的格式与大小一致，否则可能会导致卸载程序出错！  ")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurStep"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ssInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n    sIcon"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{tmp}\\uninstall.ico'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义卸载图标  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ExtractTemporaryFile('UpdateIcon.dll');//该动态链接库可网上查找  ")]),t._v("\n    ExtractTemporaryFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExtractFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//释放卸载图标  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//要替换图标的exe文件路径名称留空，则插件会自动替换掉Inno卸载程序的图标！  ")]),t._v("\n    UpdateUninstIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sIcon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//替换卸载图标  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurStep"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ssDone "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定新的卸载文件名（不包含扩展名），请相应修改！    ")]),t._v("\n    NewUninsName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'YoyaUninstall'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 应用程序名称，与 [SEUTP] 段的 AppName 必须一致，请相应修改！    ")]),t._v("\n    MyAppName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'优芽互动电影播放器'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以下重命名卸载文件    ")]),t._v("\n    uninspath"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" ExtractFilePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{uninstallexe}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    uninsname"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Copy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExtractFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{uninstallexe}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    RenameFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uninspath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" uninsname "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uninspath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" NewUninsName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    \n    RenameFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uninspath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" uninsname "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.dat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uninspath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" NewUninsName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.dat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 以下修改相应的注册表内容  ")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" RegKeyExists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#APPID}_is1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("  \n    RegWriteStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#APPID}_is1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UninstallString'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" uninspath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" NewUninsName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    RegWriteStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Wow6432Node\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\{#APPID}_is1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'QuietUninstallString'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" uninspath "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" NewUninsName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.exe\" /SILENT'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("     \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"判断程序是否安装-1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#判断程序是否安装-1"}},[t._v("#")]),t._v(" 判断程序是否安装(1)")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//  判断程序是否存在，卸载程序，多安装程序窗口判断")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\nis_Sys "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" is_value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nS_syschar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" S_currentchar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" S_current"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("S_sys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" S"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ResultStr "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nI "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("CloseNum"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nErrorCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nGuid_names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("window_name "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TArrayOfString"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbool  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" AppName"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{D0D0B722-C6F9-4A89-AB56-1417B9BD1400}_is1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{程序安装前判断主程序是否在运行}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeSetup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" RegGetSubkeyNames"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Guid_names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" I"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("to")]),t._v(" GetArrayLength"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Guid_names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("do")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n      S "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Guid_names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//注册表中找到了此键")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" AppName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Guid_names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n        bool "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" RegQueryStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("S"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'UninstallString'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ResultStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ResultStr := RemoveQuotes(ResultStr);")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" bool "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n           "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'安装程序检测到当前计算机已经安装了AIS_Server。'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("#13#13")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'您是否要卸载AIS_Server？'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  mbConfirmation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_YESNO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" IDYES "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   ShellExec('', ExpandConstant('{app}\\unins000.exe'), '','', SW_SHOW, ewNoWait, ResultCode);")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n              Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("RemoveQuotes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ResultStr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SW_SHOW"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ewWaitUntilTerminated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n              "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//zdx 5.8 判断是否已经打开了一个安装程序")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" FindWindowbyWindowName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'安装 - AIS_Server'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n          MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'安装程序检测到有另外一个安装程序已经在运行了'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbConfirmation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("break")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" I "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" GetArrayLength"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Guid_names"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n\n")])])]),s("h2",{attrs:{id:"判断程序是否已安装-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#判断程序是否已安装-2"}},[t._v("#")]),t._v(" 判断程序是否已安装（2）")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 修改注册表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Registry"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nRoot"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" HKLM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Subkey"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Software\\The Application"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueType"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Installed version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" ValueData"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" uninsdeletekey\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" GetInstalledVersion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\nInstalledVersion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\nInstalledVersion "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nRegQueryStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKLM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Software\\The Application'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Installed version'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" InstalledVersion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" InstalledVersion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" InitializeSetup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\nPrevVer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\nPrevVer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" GetInstalledVersion"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PrevVer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//如果发现程序已经安装过了")]),t._v("\nMsgBox "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'本程序的 '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" PrevVer "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' 版本已经安装，请卸载后再安装本程序. 安装程序将关闭.'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"下载、复制、删除文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载、复制、删除文件"}},[t._v("#")]),t._v(" 下载、复制、删除文件")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("itd_addfile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://test.com/Test.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{src}\\Test.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Copy the file when it's finished the download")]),t._v("\nFileCopy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{tmp}\\Test.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}\\Test.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Delete the old file")]),t._v("\nDeleteFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{src}\\Test.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"自定义函数控制文件安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义函数控制文件安装"}},[t._v("#")]),t._v(" 自定义函数控制文件安装")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 验证文件是否执行")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Files"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "MYPROG'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('EXE"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Check"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" MyProgCheck\nSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "A\\MYFILE'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('TXT"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Check"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" MyDirCheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}\\A'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nSource"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "B\\MYFILE'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('TXT"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" DestDir"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Check"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" DirExists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}\\B'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  MyProgChecked"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  MyProgCheckResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 根据用户自定义返回")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" MyProgCheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" MyProgChecked "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    MyProgCheckResult "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Do you want to install MyProg.exe to '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" ExtractFilePath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurrentFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'?'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbConfirmation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_YESNO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" idYes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    MyProgChecked "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" MyProgCheckResult"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 判断文件夹是否存在")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" MyDirCheck"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DirName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" DirExists"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("DirName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"其他自定义函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他自定义函数"}},[t._v("#")]),t._v(" 其他自定义函数")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 执行程序")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" TaskUninstallShell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}\\uninstall.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SW_HIDE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     ewWaitUntilTerminated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 关闭进程")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" TaskKillProcessByName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" FileName "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'taskkill.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/f /im '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" FileName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SW_HIDE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     ewWaitUntilTerminated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 卸载serverDaemon服务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" TaskShutDownDaemon"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n     Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}\\paperless\\ServerDaemon\\ServerDaemon.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' -d '")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SW_SHOW"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     ewWaitUntilTerminated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 停止服务")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" TaskStopService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" FileName "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n    Exec"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'net.exe'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("' stop '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" FileName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SW_HIDE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n     ewWaitUntilTerminated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ResultCode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"完全删除"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#完全删除"}},[t._v("#")]),t._v(" 完全删除")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("UninstallRun"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nFilename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{cmd}")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Parameters"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("c rd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("s "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v('q ""'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),t._v('"""'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Flags"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" hidewizard runhidden\n\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("UninstallDelete"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{app}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" filesandordirs\n\n")])])]),s("h2",{attrs:{id:"设置环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置环境变量"}},[t._v("#")]),t._v(" 设置环境变量")]),t._v(" "),s("p",[t._v("零、使用cmd添加 (必须重启才能生效)")]),t._v(" "),s("div",{staticClass:"language-cmd extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('set "str=HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment"\nfor /f "skip=2 tokens=2*" %%a in (\'REG QUERY "%str%" /v Path\') do set "regstr=%%b"\nset src=%ROOT_PATH%ffmpeg\\bin\\\nif "%src%"=="" goto :eof\necho %regstr%|find ";%src%">nul&&echo 已经存在%src%||(\n  setlocal enabledelayedexpansion\n  set "regstr=!regstr!;%src%"\n  reg add "!str!" /v Path /t REG_EXPAND_SZ /f /d "!regstr!\n  endlocal\n)\n')])])]),s("p",[t._v("一、在[setup]段添加")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("ChangesEnvironment"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),t._v("\n")])])]),s("p",[t._v("说明：让安装包在结束后，通知系统环境变量已经改变。")]),t._v(" "),s("p",[t._v("二、在[code]段添加")]),t._v(" "),s("blockquote",[s("p",[t._v("对于Windows NT系统，环境变量的设置，当前用户变量对应到注册表项HKEY_CURRENT_USER\\Environment，系统环境变量对应到注册表项HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment，所以对于环境变量可以在安装或卸载时通过注册表的修改进行设置。")])]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设置环境变量函数")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" SetEnv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aEnvName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aEnvValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" aIsInstall"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aIsInsForAllUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\nsOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nS1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nbRetValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bInsForAllUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nSL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TStringList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\nbInsForAllUser "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" aIsInsForAllUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" UsingWinNT "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" bInsForAllUser "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n     bRetValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" RegQueryStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aEnvName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n     bRetValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" RegQueryStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_CURRENT_USER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Environment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aEnvName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n   sOrgValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Trim"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n     S1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" aEnvValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" pos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Uppercase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Uppercase"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//还没有加入")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" aIsInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n         x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" Length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("StringOfChar"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("';'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n           sOrgValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" sOrgValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("';'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         sOrgValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" sOrgValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" S1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" aIsInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n         StringChangeEx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" S1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("';'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         StringChangeEx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" S1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" bInsForAllUser "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       RegWriteStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_LOCAL_MACHINE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aEnvName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" aIsInstall"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Trim"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n         RegDeleteValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_CURRENT_USER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Environment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aEnvName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n         RegWriteStringValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("HKEY_CURRENT_USER"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Environment'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aEnvName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sOrgValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//非NT 系统,如Win98")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n   SL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" TStringList"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n     sFileName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{sd}\\autoexec.bat'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     LoadStringFromFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" S1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     SL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" s1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     s1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" aEnvValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\"'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     s1 "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'set '")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("aEnvName "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'=%path%;'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" s1 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n     bRetValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" SL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("IndexOf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" aIsInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n         SL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Add"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         bRetValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//还没添加")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" aIsInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n         SL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Delete"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n         bRetValue "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n     "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" bRetValue "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n       SL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SaveToFile"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v("\n     SL"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("free"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 安装前添加环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CurStepChanged"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TSetupStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurStep "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ssInstall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将{app}路径添加到path环境变量中")]),t._v("\n    SetEnv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//在这儿调用,一定在这儿调用,安装完无须重启,立即生效")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 卸载前删除环境变量")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CurUninstallStepChanged"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurUninstallStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TUninstallStep"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 将{app}路径从path环境变量中删除")]),t._v("\n SetEnv"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ExpandConstant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{app}'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"自定义界面保存xml文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义界面保存xml文件"}},[t._v("#")]),t._v(" 自定义界面保存xml文件")]),t._v(" "),s("blockquote",[s("ol",[s("li",[t._v("读取xml 文件")])])]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  CustomEdit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TEdit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  CustomPageID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" LoadValueFromXML"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" AFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" APath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  XMLNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  XMLDocument "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" CreateOleObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Msxml2.DOMDocument.6.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n    XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parseError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errorCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n      MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'The XML file could not be parsed. '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" \n        XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parseError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reason"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n      XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setProperty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SelectionLanguage'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'XPath'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      XMLNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selectSingleNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" XMLNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v("\n    MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occured!'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("#13#10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" GetExceptionMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("blockquote",[s("p",[t._v("2.修改xml文件")])]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" SaveValueToXML"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" AFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" APath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" AValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("string")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("\n  XMLNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Variant"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  XMLDocument "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" CreateOleObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Msxml2.DOMDocument.6.0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v("\n    XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("async "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("False")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parseError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("errorCode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n      MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'The XML file could not be parsed. '")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" \n        XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("parseError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reason"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n      XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("setProperty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'SelectionLanguage'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'XPath'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      XMLNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("selectSingleNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("APath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      XMLNode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" AValue"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      XMLDocument"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("save"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("AFileName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("except")]),t._v("\n    MsgBox"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'An error occured!'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("#13#10")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" GetExceptionMessage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mbError"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" MB_OK"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("blockquote",[s("p",[t._v("3.自定义修改xml界面")])]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CreatOnEditIpPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v("  \n  CustomPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TWizardPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  CustomPage "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" CreateCustomPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wpWelcome"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Custom Page'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Enter the new value that will be saved into the XML file'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  CustomPageID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" CustomPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  CustomEdit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" TEdit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Create"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("WizardForm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  CustomEdit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Parent "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" CustomPage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Surface"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("blockquote",[s("ol",{attrs:{start:"4"}},[s("li",[t._v("使用")])])]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 系统过程，判断pageID，读取xml文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("procedure")]),t._v(" CurPageChanged"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurPageID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurPageID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomPageID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    CustomEdit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" LoadValueFromXML"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'C:\\Program Files\\Inno Setup 5\\test\\config.xml'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'//ServerConf/CMSIP'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 系统函数，根据pageID，判断点击下一步图标，保存xml文件")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" NextButtonClick"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("CurPageID"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Integer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Boolean"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("True")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" CurPageID "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomPageID "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    SaveValueToXML"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'C:\\Program Files\\Inno Setup 5\\test\\config.xml'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'//ServerConf/CMSIP'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" CustomEdit"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"ini文件修改字段-获取安装包语言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ini文件修改字段-获取安装包语言"}},[t._v("#")]),t._v(" ini文件修改字段 (获取安装包语言)")]),t._v(" "),s("div",{staticClass:"language-pascal extra-class"},[s("pre",{pre:!0,attrs:{class:"language-pascal"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("Code"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" MyLangName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Param"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("begin")]),t._v("               \n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("Result")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":=")]),t._v(" ActiveLanguage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("end")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用pascal 获取语言类型修改ini文件")]),t._v("\nFilename"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "lan'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v('ini"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Section"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "settings"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" Key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "language"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(' "'),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("{code:MyLangName}")]),t._v('"'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);