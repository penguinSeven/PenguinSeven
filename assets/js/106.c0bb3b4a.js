(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{441:function(e,t,n){"use strict";n.r(t);var a=n(25),s=Object(a.a)({},(function(){var e=this,t=e._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h3",{attrs:{id:"inno-setup-常见问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#inno-setup-常见问题"}},[e._v("#")]),e._v(" inno setup 常见问题")]),e._v(" "),t("h4",{attrs:{id:"_1-系统管理员运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-系统管理员运行"}},[e._v("#")]),e._v(" 1. 系统管理员运行")]),e._v(" "),t("blockquote",[t("p",[t("code",[e._v("Inno Setup")]),e._v("打包的程序安装完成后运行失败，\n这个是因为权限不够，我们可以通过下面的办法解决：\n找到"),t("code",[e._v("Inno Setup")]),e._v("安装目录下的"),t("code",[e._v("SetupLdr.e32")]),e._v("文件，\n然后用"),t("code",[e._v("Resource Hacker")]),e._v("软件打开，将"),t("code",[e._v("Manifest")]),e._v("改成")])]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('<requestedExecutionLevel level="requireAdministrator"  uiAccess="false"/>\n')])])]),t("p",[e._v("然后保存，就行啦。")]),e._v(" "),t("h4",{attrs:{id:"_2-添加程序到右键"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加程序到右键"}},[e._v("#")]),e._v(" 2. 添加程序到右键")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\nRoot: HKCR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" Subkey: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"*\\shell\\Open with Notepad'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\c"}},[e._v("\\c")]),e._v('ommand"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" ValueType: string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" ValueName: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('""')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" ValueData: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{app}'),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[e._v("\\n")]),e._v("otepad"),t("span",{pre:!0,attrs:{class:"token entity",title:"\\n"}},[e._v("\\n")]),e._v('otepad++.exe %1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("   Flags: deletekey uninsdeletekey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n")])])]),t("h4",{attrs:{id:"_3-开机启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-开机启动"}},[e._v("#")]),e._v(" 3.开机启动")]),e._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("[")]),e._v("Registry"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v("]")]),e._v("\nRoot: HKLM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" Subkey: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" ValueType: string"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" ValueName: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"paperless"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" ValueData: "),t("span",{pre:!0,attrs:{class:"token string"}},[e._v('"{app}\\{#MyAppExeName}"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v(" Flags: deletekey uninsdeletekey"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[e._v(";")]),e._v("\n\n")])])]),t("h3",{attrs:{id:"_4-判断进程是否正在运行"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-判断进程是否正在运行"}},[e._v("#")]),e._v(" 4.判断进程是否正在运行")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("[Code]\n\nfunction IsModuleLoaded(modulename: AnsiString ):  Boolean;\nexternal 'IsModuleLoaded@files:psvince.dll stdcall';\n\nvar\nPage: TWizardPage;\nRadioButton1, RadioButton2: TRadioButton;\nLbl1, Lbl2: TNewStaticText;\nTaskCode: Boolean;\n\n// PSVince控件在64位系统（Windows 7/Server 2008/Server 2012）下无法检测到进程，使用下面的函数可以解决。\nfunction IsAppRunning(const FileName : string): Boolean;\nvar\n   FSWbemLocator: Variant;\n   FWMIService   : Variant;\n   FWbemObjectSet: Variant;\nbegin\n   Result := false;\n   try\n     FSWbemLocator := CreateOleObject('WBEMScripting.SWBEMLocator');\n     FWMIService := FSWbemLocator.ConnectServer('', 'root\\CIMV2', '', '');\n     FWbemObjectSet := FWMIService.ExecQuery(Format('SELECT Name FROM Win32_Process Where Name=\"%s\"',[FileName]));\n     Result := (FWbemObjectSet.Count > 0);\n     FWbemObjectSet := Unassigned;\n     FWMIService := Unassigned;\n     FSWbemLocator := Unassigned;\n   except\n     if (IsModuleLoaded(FileName)) then\n       begin\n         Result := false;\n       end\n     else\n       begin\n         Result := true;\n       end\n     end;\nend;\n")])])]),t("h3",{attrs:{id:"_5-判断安装-net-4-0"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-判断安装-net-4-0"}},[e._v("#")]),e._v(" 5. 判断安装 “.net 4.0”")]),e._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v('#define IncludeFramework true  \n\n  \n[Files]\n#if IncludeFramework\nSource: "E:\\无纸化会议客户端\\ext\\dotNetFx40_Full_x86_x64.exe"; DestDir: "{tmp}"; Flags: ignoreversion {#IsExternal}; Check: NeedsFramework\n#endif  \n  \n[Run]\n#if IncludeFramework\nFilename: {tmp}\\dotNetFx40_Full_x86_x64.exe; Parameters: "/q:a /c:""install /l /q"""; WorkingDir: {tmp}; Flags: skipifdoesntexist; StatusMsg: "Installing .NET Framework if needed"\n#endif\n\n  \n[code]\n\n// Indicates whether .NET Framework 2.0 is installed.\nfunction IsDotNET40Detected(): boolean;\nvar\n    success: boolean;\n    install: cardinal;\nbegin\n    success := RegQueryDWordValue(HKLM, \'SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v4\\Full\', \'Install\', install);\n     //success := RegQueryDWordValue(HKLM, \'SOFTWARE\\Microsoft\\NET Framework Setup\\NDP\\v2.0.50727\', \'Install\', install);\n    Result :=  success and (install = 1);\nend;\n\n//RETURNS OPPOSITE OF IsDotNet20Detected FUNCTION\n//Remember this method from the Files section above\nfunction NeedsFramework(): Boolean;\nbegin\n  Result := (IsDotNET40Detected = false);\nend;\n\nfunction GetCustomSetupExitCode(): Integer;\nbegin\n  if (IsDotNET40Detected = false) then\n    begin\n      MsgBox(\'.NET Framework 未能正确安装!\',mbError, MB_OK);\n      result := -1\n    end\nend;\n')])])])])}),[],!1,null,null,null);t.default=s.exports}}]);