(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{393:function(s,a,t){"use strict";t.r(a);var p=t(25),n=Object(p.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"oneinstack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#oneinstack"}},[s._v("#")]),s._v(" Oneinstack")]),s._v(" "),a("h2",{attrs:{id:"扩展技巧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#扩展技巧"}},[s._v("#")]),s._v(" 扩展技巧")]),s._v(" "),a("h3",{attrs:{id:"php-多版本共存"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#php-多版本共存"}},[s._v("#")]),s._v(" PHP 多版本共存")]),s._v(" "),a("blockquote",[a("p",[s._v("本教程默认安装php7，尝试安装php5.6")])]),s._v(" "),a("ul",[a("li",[s._v("停止php-fpm")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" php-fpm stop\n")])])]),a("ul",[a("li",[s._v("备份启动脚本")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/init.d/php-fpm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(",_bk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#后面需要再安装php会覆盖，备份启动脚本")]),s._v("\n")])])]),a("blockquote",[a("p",[s._v("默认php7安装路径是/usr/local/php，如果再次安装会提示php已经安装，\n因此必须修改options.conf的php安装目录，将php5.6安装路径设置为/usr/local/php5，\n修改/root/oneinstack/options.conf：")])]),s._v(" "),a("ul",[a("li",[a("p",[s._v("再次执行"),a("code",[s._v("./install.sh")]),s._v("，选择"),a("code",[s._v("Install php-5.6")]),s._v("，其余均选择n，等待ing")])]),s._v(" "),a("li",[a("p",[s._v("修改php配置文件")])])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" php-fpm stop "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#停止php5.6启动脚本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/init.d/php-fpm /etc/init.d/php5-fpm  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重命名php5.6启动脚本")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /etc/init.d/php-fpm_bk /etc/init.d/php-fpm  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#恢复php7启动脚本")]),s._v("\n")])])]),a("ul",[a("li",[s._v("设置php5.6、php7开机自启动：")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CentOS:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--add")]),s._v(" php5-fpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--add")]),s._v(" php-fpm\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" php5-fpm on\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" php-fpm on\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ubuntu/Debian:")]),s._v("\nupdate-rc.d php5-fpm defaults\nupdate-rc.d php-fpm defaults\n")])])]),a("ul",[a("li",[s._v("防止php5.6、php7监听sock冲突，修改php5.6的listen，更改配置文件/usr/local/php5/etc/php-fpm.conf：0")])]),s._v(" "),a("div",{staticClass:"language-config extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("listen = /dev/shm/php-cgi.sock\n#改成\nlisten = /dev/shm/php5-cgi.sock\n")])])]),a("ul",[a("li",[s._v("手工启动php5.6、php7：")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" php5-fpm start  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动php5.6")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" php-fpm start "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#启动php7")]),s._v("\n")])])]),a("ul",[a("li",[s._v("对需要使用"),a("code",[s._v("php5.6")]),s._v("的nginx配置文件进行修改")])]),s._v(" "),a("div",{staticClass:"language-config extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("fastcgi_pass unix:/dev/shm/php-cgi.sock;\n#改成\nfastcgi_pass unix:/dev/shm/php5-cgi.sock;\n")])])]),a("ul",[a("li",[s._v("重启nginx")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx restart\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);